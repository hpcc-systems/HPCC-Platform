import{_ as a,a as s,o as e,ag as n}from"./chunks/framework.Do1Zayaf.js";const k=JSON.parse('{"title":"JavaEmbedNativeLogging Build Documentation","description":"","frontmatter":{},"headers":[],"relativePath":"testing/regress/ecl/javaembedNativeLoggingBuildInfo.md","filePath":"testing/regress/ecl/javaembedNativeLoggingBuildInfo.md","lastUpdated":1771585025000}'),t={name:"testing/regress/ecl/javaembedNativeLoggingBuildInfo.md"};function l(p,i,h,o,r,d){return e(),s("div",null,i[0]||(i[0]=[n(`<h1 id="javaembednativelogging-build-documentation" tabindex="-1">JavaEmbedNativeLogging Build Documentation <a class="header-anchor" href="#javaembednativelogging-build-documentation" aria-label="Permalink to &quot;JavaEmbedNativeLogging Build Documentation&quot;">​</a></h1><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>This document describes the compilation process for <code>javaembedNativeLogging.java</code> into JAR and class files for use with HPCC Systems&#39; Java Embedded Plugin.</p><h2 id="source-files-structure" tabindex="-1">Source Files Structure <a class="header-anchor" href="#source-files-structure" aria-label="Permalink to &quot;Source Files Structure&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>testing/regress/ecl/</span></span>
<span class="line"><span>├── javaembedNativeLogging.java      # Main Java source file</span></span>
<span class="line"><span>├── javaembedNativeLogging.ecl       # ECL test script</span></span>
<span class="line"><span>├── javaembedNativeLogging.manifest  # Resource manifest for HPCC</span></span>
<span class="line"><span>└── javaembedNativeLoggingPOM.xml    # Maven build configuration</span></span></code></pre></div><h2 id="maven-build" tabindex="-1">Maven Build <a class="header-anchor" href="#maven-build" aria-label="Permalink to &quot;Maven Build&quot;">​</a></h2><p>The jar file can be built using Maven with the provided POM configuration.</p><p><strong>Dependencies:</strong></p><ul><li>Log4j Core 2.20.0</li><li>Log4j API 2.20.0</li><li>Java 17 (configurable)</li><li>Apache Maven 3.8.7</li></ul><p><strong>Build Commands:</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (Recommended) Copy sources to external build directory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> buildJavaEmbedNativeLogging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> HPCC-Platform/testing/regress/ecl/javaembedNativeLogging</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./buildJavaEmbedNativeLogging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> buildJavaEmbedNativeLogging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Copy java source code to src/main/java/test (configured by groupid in pom.xml)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src/main/java/test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> javaembedNativeLogging.java</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src/main/java/test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Compile source code</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mvn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clean</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> assembly:single</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> javaembedNativeLoggingPOM.xml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Output locations:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - target/classes/javaembedNativeLogging.class</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - target/javaembedNativeLogging-1.0.0-jar-with-dependencies.jar</span></span></code></pre></div><p><strong>Maven Configuration Features:</strong></p><ul><li>Assembly plugin creates fat JAR with all dependencies</li><li>Compiler plugin ensures proper Java version targeting (Avoids pre-intalled java runtime complaining about too new of version in some installations)</li><li>Targets Java 17</li></ul><h2 id="integration-with-hpcc" tabindex="-1">Integration with HPCC <a class="header-anchor" href="#integration-with-hpcc" aria-label="Permalink to &quot;Integration with HPCC&quot;">​</a></h2><h3 id="manifest-configuration" tabindex="-1">Manifest Configuration <a class="header-anchor" href="#manifest-configuration" aria-label="Permalink to &quot;Manifest Configuration&quot;">​</a></h3><p>The <code>.manifest</code> file declares the JAR resource so it can be included in the workunit:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Manifest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Resource</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;jar&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> filename</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;javaembedNativeLogging.jar&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Manifest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h3 id="ecl-integration" tabindex="-1">ECL Integration <a class="header-anchor" href="#ecl-integration" aria-label="Permalink to &quot;ECL Integration&quot;">​</a></h3><p>The ECL script imports the Java function:</p><div class="language-ecl vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ecl</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">STRING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> testLogging(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">STRING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message) :</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IMPORT(java, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;javaembedNativeLogging.testLogging:(Ljava/lang/String;)Ljava/lang/String;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="deployment-considerations" tabindex="-1">Deployment Considerations <a class="header-anchor" href="#deployment-considerations" aria-label="Permalink to &quot;Deployment Considerations&quot;">​</a></h3><ul><li>Use fat JAR to avoid classpath dependency issues</li><li>Configure Log4j settings <ul><li>via environment.conf (Bare-metal) <ul><li><code>log4jLevel</code></li><li><code>log4jPattern</code></li></ul></li><li>via HPCC environment variables (Containerized): <ul><li><code>HPCC_JAVA_EMBED_LOG4J_LEVEL</code></li><li><code>HPCC_JAVA_EMBED_LOG4J_PATTERN</code></li></ul></li></ul></li></ul>`,22)]))}const c=a(t,[["render",l]]);export{k as __pageData,c as default};
