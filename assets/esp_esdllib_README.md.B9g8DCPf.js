import{_ as i,a as t,o as a,ag as e}from"./chunks/framework.Do1Zayaf.js";const E=JSON.parse('{"title":"ESDL Scripting","description":"","frontmatter":{},"headers":[],"relativePath":"esp/esdllib/README.md","filePath":"esp/esdllib/README.md","lastUpdated":1771585025000}'),n={name:"esp/esdllib/README.md"};function l(h,s,p,r,k,d){return a(),t("div",null,s[0]||(s[0]=[e(`<h1 id="esdl-scripting" tabindex="-1">ESDL Scripting <a class="header-anchor" href="#esdl-scripting" aria-label="Permalink to &quot;ESDL Scripting&quot;">​</a></h1><p>ESDL Script is a highly domain specific proprietary scripting language and engine built into the ESP. The engine&#39;s close integration with the ESP allows it to expose scripting Entry Points at important steps in the lifetime of an ESP transaction. Each Entry Point presents an opportunity to run scripts that modify the context holding the transaction state, passing the modified context to the next transaction step.</p><p>The markup syntax of the scripting language is XML based and purpose-built for scripting the business logic needed in ESP services. These three features make it well suited to that task:</p><ul><li>Most Entry Point scripts operate on a copy of their expected output, so you only need to make the minimum modifications necessary instead of building up the entire output from scratch.</li><li>It has operations that help with common ESP transaction logic, like running MySQL queries, making SOAP calls, input validation, and checking a user&#39;s authorization status.</li><li>ESDL Scripts are parsed and transformed into execution graphs at startup, then the execution graphs are executed at runtime. Your ESDL Script business logic is isolated from the compiled C++ code of the platform, and can be separately managed and updated.</li></ul><h2 id="history" tabindex="-1">History <a class="header-anchor" href="#history" aria-label="Permalink to &quot;History&quot;">​</a></h2><p>ESDL started as a way to standardize and streamline service and microservice development, and has seen continual improvement to support more complex uses. Its foundational features let us stand up a front end service for a roxie backend with just an interface description and no other customized logic or coding. Starting there we have the benefit of robust interfaces isolated from the compiled code of the HPCC Platform itself. You can easily update a service&#39;s interface or its configuration binding it to the backend without building or deploying any new C++ code.</p><p>The desire to use ESDL for more services brought plugin support for customized logging and authentication. However, even with logging and authentication plugins available we saw the need for customization and logic beyond the standard transaction steps of &quot;authenticate, call backend then log&quot;. To support this customization and logic we&#39;ve implemented the ESDL Scripting language with an engine that hooks into various steps of the transaction.</p><p>This document is an overview and reference of the ESDL Scripting language.</p><h2 id="table-of-contents" tabindex="-1">Table of Contents <a class="header-anchor" href="#table-of-contents" aria-label="Permalink to &quot;Table of Contents&quot;">​</a></h2><ul><li><a href="#esdl-scripting">ESDL Scripting</a><ul><li><a href="#history">History</a></li><li><a href="#table-of-contents">Table of Contents</a></li></ul></li><li><a href="#language-overview">Language Overview</a><ul><li><a href="#basic-example">Basic Example</a></li><li><a href="#transaction-flow-and-entry-points">Transaction Flow and Entry Points</a></li><li><a href="#scripting-context">Scripting Context</a></li><li><a href="#configuration">Configuration</a><ul><li><a href="#esp-launch-mode-influences-configuration-format">ESP Launch Mode Influences Configuration Format</a></li><li><a href="#service-bundle-configuration-commonalities">Service Bundle Configuration Commonalities</a></li><li><a href="#application-mode">Application Mode</a></li><li><a href="#legacy-mode">Legacy Mode</a></li><li><a href="#debugging">Debugging</a></li><li><a href="#logging">Logging</a></li><li><a href="#service-security">Service Security</a></li></ul></li></ul></li><li><a href="#reference">Reference</a><ul><li><a href="#conventions">Conventions</a><ul><li><a href="#implicit-variables">Implicit Variables</a></li><li><a href="#system-parameters">System Parameters</a></li></ul></li><li><a href="#entry-points">Entry Points</a><ul><li><a href="#backendrequest">BackendRequest</a></li><li><a href="#backendresponse">BackendResponse</a></li><li><a href="#esdlresponse">EsdlResponse</a></li><li><a href="#prelogging">PreLogging</a></li><li><a href="#service">Service</a></li></ul></li><li><a href="#xpath">XPath</a><ul><li><a href="#variable-resolution">Variable Resolution</a><ul><li><a href="#location-paths-and-predicates">Location Paths and Predicates</a></li><li><a href="#expressions-and-function-arguments">Expressions and Function Arguments</a></li></ul></li><li><a href="#extensions">Extensions</a></li><li><a href="#namespaces">Namespaces</a><ul><li><a href="#soap-example">soap Example</a></li><li><a href="#default-namespace-examples">Default Namespace Examples</a></li></ul></li><li><a href="#exslt-functions">EXSLT Functions</a></li><li><a href="#custom-functions">Custom Functions</a><ul><li><a href="#ensuredatasection">ensureDataSection</a><ul><li><a href="#example">Example</a></li></ul></li><li><a href="#getdatasection">getDataSection</a><ul><li><a href="#example-1">Example</a></li></ul></li><li><a href="#getfeaturesecaccessflags">getFeatureSecAccessFlags</a></li><li><a href="#getlogoption">getLogOption</a></li><li><a href="#getlogprofile">getLogProfile</a></li><li><a href="#getstoredstringvalue">getStoredStringValue</a></li><li><a href="#logoptionexists">logOptionExists</a></li><li><a href="#secureaccessflags">secureAccessFlags</a></li><li><a href="#storedvalueexists">storedValueExists</a></li><li><a href="#tokenize">tokenize</a></li><li><a href="#example-2">Example</a></li><li><a href="#validatefeaturesaccess">validateFeaturesAccess</a></li></ul></li></ul></li><li><a href="#operations">Operations</a><ul><li><a href="#add-value">add-value</a></li><li><a href="#append-to-value">append-to-value</a></li><li><a href="#assert">assert</a></li><li><a href="#choose">choose</a></li><li><a href="#copy-of">copy-of</a></li><li><a href="#element">element</a></li><li><a href="#ensure-target">ensure-target</a></li><li><a href="#fail">fail</a></li><li><a href="#for-each">for-each</a></li><li><a href="#http-post-xml">http-post-xml</a><ul><li><a href="#example-3">Example</a></li></ul></li><li><a href="#if">if</a></li><li><a href="#if-source">if-source</a></li><li><a href="#if-target">if-target</a></li><li><a href="#mysql">mysql</a><ul><li><a href="#credentials">Credentials</a></li><li><a href="#examples">Examples</a></li></ul></li><li><a href="#namespace">namespace</a></li><li><a href="#param">param</a></li><li><a href="#remove-node">remove-node</a></li><li><a href="#rename-node">rename-node</a></li><li><a href="#set-log-option">set-log-option</a></li><li><a href="#set-log-profile">set-log-profile</a></li><li><a href="#set-value">set-value</a></li><li><a href="#source">source</a></li><li><a href="#store-value">store-value</a></li><li><a href="#target">target</a></li><li><a href="#variable">variable</a></li></ul></li></ul></li></ul><h1 id="language-overview" tabindex="-1">Language Overview <a class="header-anchor" href="#language-overview" aria-label="Permalink to &quot;Language Overview&quot;">​</a></h1><p>The ESDL Script language consists of XML elements and XPath functions. A script is an ordered collection of XML elements that may use XPath functions. Each element is either an <em>entry point</em> or an <em>operation</em>.</p><p>An <em>entry point</em> element is named after a step in the ESDL transaction workflow. It is the root node of a list of ordered <em>operations</em>. Each <em>entry point</em> may have multiple <em>entry point</em> elements. The <em>operations</em> are defined in the <code>urn:hpcc:esdl:script</code> namespace. As the ESP processes a transaction, it steps into each defined script <em>entry point</em> in turn and executes each <em>entry point</em> element in order. Likewise, each <em>entry point</em> element executes its <em>operations</em> in order.</p><p>Each entry point has default <em>source</em> and <em>target</em> XML nodes. Most <em>entry points</em> start by copying the <em>source</em> through to the <em>target</em>, with exceptions noted in the <a href="#entry-points">Entry Points reference</a>. Default <em>operation</em> behavior reads from the <em>source</em> and applies changes to the <em>target</em>.</p><p>Most services contain methods that call out to a backend server such as a roxie. However, a service method can be written purely in ESDL Script without calling to a backend server. There is a special entry point used in this case that must construct the resulting target XML node. Refer to the <a href="#entry-points">Entry Points</a> reference for more details on all entry points.</p><p>As the operations are executed in each entry point, the ESDL Script engine maintains an <em>ESDL Script context</em> that holds state between operations, including elements corresponding to the <em>source</em> and <em>target</em> nodes of the entry points, and other nodes created by other ESDL Script operations. The <a href="#scripting-context">Scripting Context</a> section has additional information.</p><p>ESDL Scripts are written in XML and share some similarites with XSLT, but are easier to understand and have some powerful new features.</p><p><strong>XSLT Similarities:</strong></p><p>How is ESDL Script like XSLT?</p><ol><li>Written in XML</li><li>Use XPaths and support standard, extended and custom XPath functions.</li><li>Variables can contain scalar or node-set values</li></ol><p><strong>XSLT Differences:</strong></p><p>How is ESDL Script different from XSLT?</p><ol><li>In most cases you don&#39;t construct a result from scratch, you <em>transform</em> an existing element into your desired result. This gives sensible default behavior with no scripting and keeps required scripts smaller.</li><li>Scripts do not use the often difficult-to-trace template matching behavior of xslt, they are procedural- executing operations in order.</li><li>There is no text content like in XSLT.</li></ol><h2 id="basic-example" tabindex="-1">Basic Example <a class="header-anchor" href="#basic-example" aria-label="Permalink to &quot;Basic Example&quot;">​</a></h2><p>A very common use case for scripts is transforming the incoming request to the ESP into a format required by a backend roxie query. When ESDL is used the interfaces will match, but customization can be required for legacy services, or when business logic demands that the request be modified in some way. This example is an introduction to the ESDL Script language and doesn&#39;t show the input validation and error handling needed in a production-ready script.</p><p>Say we have an incoming ESP request in this format:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:soap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:SOAP-ENC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpccsystems:ws:wssample:testmethod&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">TestMethodRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">StartDate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Year</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;1976&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Year</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Month</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;07&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Month</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;12&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">StartDate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">SearchBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">First</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Jon&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">First</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Last</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Jonson&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Last</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">SearchBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">TestMethodRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>When using ESDL in front of a roxie query, there is a built in default transformation which produces a call to roxie that looks something like this (Sample 1):</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:soap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">TestModule.TestMethodService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...etc...&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">TestMethodRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">StartDate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Year</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;1976&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Year</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Month</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;07&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Month</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;12&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">StartDate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">SearchBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">First</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Jon&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">First</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Last</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Jonson&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Last</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">SearchBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">TestMethodRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">TestModule.TestMethodService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>However, let&#39;s say the backend query expects a few differences -</p><ol><li>StartDate is in YYYYMMDD format</li><li>Options must include the <code>ExtendedSearchEnable</code> Secure User Setting (from the Authorization results of the Security Manager plugin)</li></ol><p>Then the backend request must look like this (Sample 2):</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:soap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">TestModule.TestMethodService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...etc...&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">TestMethodRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">StartDate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;19760712&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">StartDate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ExtendedSearchEnable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;1&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ExtendedSearchEnable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">SearchBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">First</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Jon&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">First</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Last</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Jonson&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Last</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">SearchBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">TestMethodRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">TestModule.TestMethodService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>A script to make this change could be coded like this:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:BackendRequest</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TransformForRoxie&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;soap:Body/{$query}/{$request}&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:es</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpcc:esdl:script&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:param</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ExtendedSearchEnable&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:source</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xpath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;soap:Body/*/*/Row/Options/StartDate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Options/StartDate&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Year&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:append-to-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Options/StartDate&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Month&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:append-to-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Options/StartDate&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Day&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:source</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Options/ExtendedSearchEnable&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{$ExtendedSearchEnable}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:BackendRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Let&#39;s discuss what each line of this script does.</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:BackendRequest</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TransformForRoxie&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;soap:Body/{$query}/{$request}&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:es</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpcc:esdl:script&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>This script consists of a single <em>entry point</em>, <code>BackendRequest</code>, that is executed after the ESDL transformer has generated the default backend request just before it is sent to the backend.</p><p>The scripting engine setup for most entry points, including <code>BackendRequest</code>, copies the <em>source</em> to the <em>target</em>. In this example the <em>source</em> and <em>target</em> start out looking like <strong>Sample 1</strong>. By the time script is completed the <em>target</em> is <strong>Sample 2</strong>.</p><p>In cases like this, the action of the script can be thought of like the assignment of a variable: <code>x = Fn(x)</code>. The Left Hand Side <strong>x</strong> is modified by the result of the expression on the Right Hand Side <strong>Fn(x)</strong>. The Left Hand Side, or LHS is called the <em>target</em> and the Right Hand Side or RHS is called the <em>source</em>.</p><p>The <code>@name</code> attribute is used for tracing and error reporting. The <code>@target</code> attribute is an XPath specifying the default root node of the target for all subsequent operations. If it is not present the root is the node <code>&lt;soap:Envelope&gt;</code>. The <code>{$query}</code> and <code>{$request}</code> variables are special system macros that are set to the name of the backend query and request respectively.</p><p>The <code>@xmlns</code> attribute is the standard XML definition of a namespace prefix. For ESDL Scripts the required namespace URN is <code>urn:hpcc:esdl:script</code>. You can define your own prefix (we use <code>es</code>), but the namespace prefixes and definitions should be consistent across all scripts in a service.</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:param</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ExtendedSearchEnable&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>This line defines a parameter named <code>ExtendedSearchEnable</code> with a default value of zero <code>0</code>. The <code>&lt;es:param&gt;</code> operation allows the script to make use of one of the values made available by the scripting engine. Setting the <code>@value</code> attribute ensures that will be the default value if the parameter is unset. This avoids triggering an error by referencing an undefined parameter.</p><p>Assume this parameter is from a <em>Secure User Property</em> assigned a value by the security manager plugin. The ESDL Script engine makes all the Secure User Properties set by the secmgr available to scripts as parameters.</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:source</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xpath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;soap:Body/*/*/Row/Options/StartDate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>This modifies the default root node of the source of all child operations. The <code>@xpath</code> attribute speficies the node to make the default source root node.</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Options/StartDate&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Year&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>This sets the value of the target node specified by <code>@target</code> to the value of the node specified by <code>@source</code>. Any previous value of <code>@target</code> is replaced by the new value of <code>@source</code>. Because this command is a child of the previous <code>&lt;es:source&gt;</code> command, the <code>@select</code> is relative to <code>soap:Body/*/*/Row/Options/StartDate</code></p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:append-to-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Options/StartDate&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Month&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:append-to-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Options/StartDate&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Day&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>These both append the value of the <code>@select</code> node to the value of the <code>@target</code> node.</p><h2 id="transaction-flow-and-entry-points" tabindex="-1">Transaction Flow and Entry Points <a class="header-anchor" href="#transaction-flow-and-entry-points" aria-label="Permalink to &quot;Transaction Flow and Entry Points&quot;">​</a></h2><p>The lifecycle of an ESP transaction is shown below in the flowchart&#39;s plain black boxes. Optionally, scripts can be inserted at any of the entry points named in the light grey boxes, and an entry point is skipped if it contains no scripts. At each entry point the script has the opportunity to transform the source in preparation for passing it on to the next transaction step.</p><div class="language-mermaid vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flowchart TD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    classDef transactionStep fill:#000;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    classDef entryPoint fill:#444;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    start(( ))--&gt;receive[Receive request]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    receive--&gt;esdl1[ESDL transforms ESP request \\n to backend request]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    esdl1--&gt;isScript{Fully Scripted-\\nno backend?}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    isScript--no--&gt;backendRequest[[BackendRequest:\\nTransform backend request\\nto final form]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    backendRequest--&gt;callBackend[Call backend]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    callBackend--&gt;backendResponse[[BackendResponse: \\nTransform backend response \\n to raw response]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    backendResponse--&gt;esdl2[ESDL transforms raw response\\n to initial ESP response]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    isScript--yes--&gt;service[[Service: \\nRun script as backend,\\n create raw response]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    service--&gt;esdl2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    esdl2--&gt;needEsdl3{EsdlResponse \\n script \\n present?}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    needEsdl3--no--&gt;send[Send\\nResponse]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    needEsdl3--yes--&gt;esdlResponse[[EsdlResponse: \\n Transform initial ESP response \\n to final ESP response]]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    esdlResponse--&gt;esdl3[ESDL transforms final ESP \\nresponse to match schema]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    esdl3--&gt;send</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    send--&gt;preLogging[[PreLogging: \\n Transform Log Request]]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    preLogging--&gt;queueLog[Log Manager dispatches Log Request]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    class start,receive,esdl1,isScript,callBackend,esdl2,esdl3,queueLog transactionStep;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    class backendRequest,service,backendResponse,esdlResponse,preLogging entryPoint;</span></span></code></pre></div><p>A script is inserted to an entry point by naming its root node after the name of the entry point. A script can replace a backend service call by configuring a method&#39;s <code>@querytype</code> to script.</p><p>Additional details about the <a href="#entry-points">entry points</a> and script <a href="#configuration">configuration</a> are found in the reference section.</p><h2 id="scripting-context" tabindex="-1">Scripting Context <a class="header-anchor" href="#scripting-context" aria-label="Permalink to &quot;Scripting Context&quot;">​</a></h2><p>The scripting engine maintains a context during the lifetime of each transaction. This context holds state for the scripts, and the results of executing the operations at each entry point. The context contains an XML document holding most of the state that script operations can inspect and modify.</p><p>Below is a first-level outline of the common sections in the XML context:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_script_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">original_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">final_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">initial_response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">pre_esdl_response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">logdata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">temporaries</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_script_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><table tabindex="0"><thead><tr><th>Context Node</th><th>Contents</th></tr></thead><tbody><tr><td><code>&lt;esdl_script_context&gt;</code></td><td>Root node, should not be accessed by scripts</td></tr><tr><td><code>&lt;esdl&gt;</code></td><td>ESDL interface definition info about the current method and service in progress.</td></tr><tr><td><code>&lt;original_request&gt;</code></td><td>The unmodified request as the ESP recieved from the client.</td></tr><tr><td><code>&lt;target&gt;</code></td><td>Configuration of the backend target from the ESDL service binding.</td></tr><tr><td><code>&lt;config&gt;</code></td><td>The <code>EspBinding</code> section from the ESDL service binding. This contains any defined security manager Authenticate configuration.</td></tr><tr><td><code>&lt;esdl_request&gt;</code></td><td>The result of sending the <code>original_request</code> through the esdl request transformer.</td></tr><tr><td><code>&lt;final_request&gt;</code></td><td>The result of any transformations the <code>BackendRequest</code> entry point has made on the <code>esdl_request</code> node.</td></tr><tr><td><code>&lt;initial_response&gt;</code></td><td>The unmodified response from the backend server, frequently a roxie.</td></tr><tr><td><code>&lt;pre_esdl_response&gt;</code></td><td>The result of any transformations the <code>BackendResponse</code> entry point has made on the <code>initial_response</code> node.</td></tr><tr><td><code>&lt;logdata&gt;</code></td><td>This node is passed on to the LoggingManager. The default source and target location of the <code>PreLogging</code> entry point.</td></tr><tr><td><code>&lt;logging&gt;</code></td><td>Log option and log profile settings are held here and passed on to the LoggingManager.</td></tr><tr><td><code>&lt;store&gt;</code></td><td>Location to store persistent values during the lifespan of the transaction.</td></tr><tr><td><code>&lt;temporaries&gt;</code></td><td>Location where temporaries and other variables are created by default.</td></tr></tbody></table><p>Some script operations will add additional elements to the context document.</p><h2 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration&quot;">​</a></h2><p>In order to understand how ESDL Scripts are associated with an ESDL service we&#39;ll look at an overview of how services are configured. This is not an exhaustive reference, but shows where ESDL Scripts are in a configuration and gives some context of the other main configuration sections. These are our best practice recommendations for configuration. Other approaches are possible, but they aren&#39;t covered here.</p><p>An ESDL service is configured from two sources- the <em>process configuration</em> and the <em>service bundle configuration</em>.</p><p>The <em>process configuration</em> controls settings such as:</p><ul><li>An ESP process for the service to run inside of</li><li>Which authentication method and plugin is used for the service</li><li>TLS settings</li><li>Trace log settings including transaction summary lines</li><li>Dali server settings</li><li>Authentication and authorization <em>Feature</em> and <em>Setting</em> entries</li></ul><p>The <em>service bundle configuration</em> controls settings such as:</p><ul><li>The ESDL interface of the service</li><li>Configuration of each <em>method</em> in the service including the backend target and any other arbitrary information the method requires</li><li>ESDL Scripts customizing behavior of the service and its methods</li><li>The <em>LoggingManager</em> and its associated <em>LogAgents</em></li><li>XSLT scripts used to prepare a logging payload, called <em>Log Transforms</em></li><li><em>Feature</em> authorization requirements</li></ul><p>The <em>process configuration</em> defines a running ESP process that loads and handles transactions from one or more ESDL services described in <em>service bundle configurations</em>.</p><h3 id="esp-launch-mode-influences-configuration-format" tabindex="-1">ESP Launch Mode Influences Configuration Format <a class="header-anchor" href="#esp-launch-mode-influences-configuration-format" aria-label="Permalink to &quot;ESP Launch Mode Influences Configuration Format&quot;">​</a></h3><p>The format of these configurations and how they&#39;re managed depends on how the ESP is launched. First is launching an ESP executable directly in <em>application mode</em> starting with an <code>esp.yaml</code> <em>process configuration</em>. Second is <em>legacy mode</em> launch where the platform&#39;s <code>environment.xml</code> <em>process configuration</em> file is used by SystemV or systemd startup scripts to launch an ESP.</p><p>First we&#39;ll explain some common sections of the <em>service bundle configuration</em> that apply to both launch modes. Then the following launch mode sections compare configuration hilights of the same service for both <em>application mode</em> and for <em>legacy configuration mode</em>.</p><p>Say we have a service named <em>WsMyService</em> that uses hypothetical authentication and logging plugins named <em>mypluginauth</em> and <em>my_logagent</em>. The service uses TLS and is exposed on port 8880. The directions and configuration examples below show the main sections for common settings but they don&#39;t go into detail or cover all possible settings.</p><h3 id="service-bundle-configuration-commonalities" tabindex="-1">Service Bundle Configuration Commonalities <a class="header-anchor" href="#service-bundle-configuration-commonalities" aria-label="Permalink to &quot;Service Bundle Configuration Commonalities&quot;">​</a></h3><p>Regardless of launch mode, <em>service bundle configuration</em> contains a <code>&lt;Binding&gt;</code> element which may hold these settings:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Binding</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> espprocess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyEspInstance&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> espbinding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Definition</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> esdlservice</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WsMyService&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WsMyService.1&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> auth_feature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Methods</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Scripts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &lt;![CDATA[&lt;Scripts&gt;...ESDL Script entry points for all methods...&lt;/Scripts&gt;]]&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Scripts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Method</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> auth_feature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> traceLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Scripts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          &lt;![CDATA[&lt;Scripts&gt;...ESDL Script entry points for this method...&lt;/Scripts&gt;]]&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Scripts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ...arbitrary configuration elements...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Method</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ...additional Methods...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Methods</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">LoggingManager</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;my_service_logman&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ...LogManager configuration...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">LogAgent</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;my_logagent&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ...LogAgent configuration...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">XSL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Transform</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &lt;![CDATA[&lt;xsl:stylesheet&gt;...XSLT...&lt;/xsl:stylesheet&gt;]]&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Transform</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">XSL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">LogAgent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ...additional LogAgents...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">LoggingManager</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Definition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Binding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Each <code>&lt;Scripts&gt;</code> element contains ESDL Script entry points that are executed as the transaction proceeds through its lifetime. Scripts in the <code>&lt;Methods&gt;</code> section are referred to as <em>service-level scripts</em>. They are executed by each method in a service. Scripts in each <code>&lt;Method&gt;</code> section are referred to as <em>method-level scripts</em> and are only executed when that method is run.</p><p>As the ESP processes a Method request and reaches each script entry point, it executes all of that entry point&#39;s scripts. The service-level scripts execute first, in order, followed by the method-level scripts in order. The CDATA sections ensure that the order of operations within each entry point&#39;s script is preserved.</p><p>ESDL service methods must have a <code>&lt;Method&gt;</code> element in the <em>service bundle config</em> to be invoked. The <code>@auth_feature</code> attribute on the <code>&lt;Definition&gt;</code> or <code>&lt;Method&gt;</code> elements specify security as described in the <a href="./README-SECURITY.html#esdl-binding">Security Readme</a>.</p><p>The <code>&lt;LoggingManager&gt;</code> section contains settings for the service&#39;s logging. The <code>&lt;LogAgent&gt;</code> elements may contain <code>XSL/Transform</code> elements used to customize the outgoing logging request before it is dispatched.</p><p>It is easiest to manage the ESDL Scripts, ESDL definitions and XSLT transforms that make up the <em>service bundle configuration</em> as separate files under source control. An upcoming feature of the <code>esdl</code> tool is a command to compile a <em>service bundle configuration</em> from these separate files.</p><h3 id="application-mode" tabindex="-1">Application Mode <a class="header-anchor" href="#application-mode" aria-label="Permalink to &quot;Application Mode&quot;">​</a></h3><p>The Application Mode ESP deployment is designed for containerized cloud deployments, but can also work on bare metal. Part of what makes it so well suited to cloud deployments is that the ESP loads all configuration from files. An ESP can be launched as one of several different kinds of applications including <code>eclwatch</code> and <code>esdl</code>. We will only consider the <em>esdl application</em> here.</p><p>An <em>esdl application</em> configuration starts with an <code>esp.yaml</code> <em>process configuration</em> file, though in cloud deployments it would be called a <em>configmap</em>. Each application mode has reasonable default values for all settings, so your file need only include customized settings. Refer to the default application mode configuration files in the <a href="https://github.com/hpcc-systems/HPCC-Platform/tree/master/esp/applications/esdl" target="_blank" rel="noreferrer">HPCCSystems repository</a> for some examples. Note that the helm installation procedure includes a step that rolls up all the separate yaml files into <code>esp.yaml</code> prior to launch.</p><p>A pared-down example of an <code>esp.yaml</code> file may look like this:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  instance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MyEspInstance</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ESDL Application for WsMyService</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  daliServers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">none</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  loadDaliBindings</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  auth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mypluginauth</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  authDomain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ... other settings</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  tls</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8880</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  bindings</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/opt/HPCCSystems/bindings&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # ... other settings</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  bindingInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    esdl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      desdlBinding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        resource_map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          WsMyService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            Feature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">access</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Read</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">              authenticate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Yes</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">              path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">AllowMyServiceExampleMethod</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">              resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">AllowMyServiceExampleMethod</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">              required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">              description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Controls access to the ExampleMethod of WsMyService</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            Setting</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PremiumUserLevel</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">              resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Premium User Level&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">              description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Value 1-3 indicating allowed level of premium features</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  tls_config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ...</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    privatekey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ... other settings</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  authNZ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    mypluginauth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      SecurityManager</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MyPluginSecmgrType</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mysecmgr</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      root_access</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EnableSOAPInterface</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Read</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Root access to service</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # ... other settings</span></span></code></pre></div><p>The chart below explains the meaning of the most important settings in the above example:</p><table tabindex="0"><thead><tr><th>Setting</th><th>Meaning</th></tr></thead><tbody><tr><td>daliServers</td><td>Name of dali server to use, or none to not use dali</td></tr><tr><td>loadDaliBindings</td><td>If false do not load service bundle configuration from dali</td></tr><tr><td>tls</td><td>If true use secure TLS connections</td></tr><tr><td>bindings</td><td>Path to all the ESDL <em>service bundle configurations</em> that this process will load and bind to listen on service.port</td></tr><tr><td>service.port</td><td>Port number to connect to bound esdl services</td></tr><tr><td>bindingInfo.esdl.desdlBinding.resource_map.WsMyService</td><td>Contains list of Feature and Setting elements that define the security resources for WsMyService using the mypluginauth security manager</td></tr><tr><td>tls_config</td><td>Element containing all the TLS settings</td></tr><tr><td>authNZ.mypluginauth</td><td>Security manager plugin settings for the mypluginauth plugin</td></tr></tbody></table><p>Now say we have a <em>service bundle configuration</em> named <code>WsMyService.xml</code> located at the <code>esp.bindings</code> path of <code>/opt/HPCCSystems/bindings</code>. In outline, the service bundle config would look like this:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">EsdlBundle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Binding</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> espprocess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyEspInstance&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> espbinding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Definition</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> esdlservice</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WsMyService&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WsMyService.1&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          ... contents described in section &#39;Service Bundle Configuration Commonalities&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Definition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Binding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Definitions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &lt;![CDATA[&lt;esxdl name=&quot;WsMyService&quot;&gt;...ESDL interface definition...&lt;/esxdl&gt;]]&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Definitions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">EsdlBundle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>For <em>esdl application</em> launches, the <em>service bundle configuration</em> contains an additional <code>&lt;Definitions&gt;</code> element which holds the ESDL definition of the service.</p><p>There are a few naming constraints that must be honored in the service bundle config and the process config. If the name of the ESDL interface is <em>WsMyService</em> (<code>EsdlBundle/Definitions/esxdl[@name] = WsMyService]</code>) that means these attributes must be named as shown:</p><ul><li><code>EsdlBundle/Binding/Definition[@esdlservice]=WsMyService</code></li><li><code>EsdlBundle/Binding/Definition[@id]=WsMyService.1</code></li></ul><blockquote><p>Note: The <code>@id</code> attribute value <code>WsMyService.1</code> has the &quot;.1&quot; appended to indicate the <em>version</em> of the definition. In <em>legacy mode</em> deployments the dali stores different versions of the interface distinguished with these sequential integers. <em>Application mode</em> only ever has one version so this convention is used.</p></blockquote><h3 id="legacy-mode" tabindex="-1">Legacy Mode <a class="header-anchor" href="#legacy-mode" aria-label="Permalink to &quot;Legacy Mode&quot;">​</a></h3><p><em>Legacy mode</em> ESP deployments are best suited to running on bare metal. Part of what makes them less suitable for cloud deployments is that they require a combination of file-based and dali-based configurations. It is not desirable to require a dali server just to hold some ESP configuration.</p><p>Configuring a <em>legacy mode</em> ESP starts by using the configmgr application to customize an <code>environment.xml</code> file. An <code>environment.xml</code> file holds all the <em>process configuration</em> settings. Details about using configmgr can be found in the HPCCSystems documents <em>Using Configuration Manager</em> and <em>Installing and Running the HPCC Environment</em> found on the <a href="https://hpccsystems.com/training/documentation/all" target="_blank" rel="noreferrer">documentation page</a>.</p><p>Opening the stock <code>environment.xml</code> from a platform install into configmgr gives us a good starting point for creating a <em>process configuration</em> to host a DESDL service. Starting with stock config take these steps to make it match the <em>process configuration</em> we created above for an <em>esdl application</em>:</p><ul><li>Add a new <strong>Component</strong>, of type &#39;esp&#39;, giving it the name MyEspInstance</li><li>Add a new <strong>Esp Service</strong> of type &#39;DynamicESDL&#39;, assigning <strong>Dynamic ESDL Service Name</strong> = WsMyService</li><li>Add a new secmgr plugin <strong>Component</strong> and configure. For this example we&#39;re calling it &#39;mysecmgr&#39;</li><li>Configure the MyEspInstance esp component: <ul><li>In <strong>ESP Service Bindings</strong> tab, Add a binding and set these attributes: <ul><li><strong>port</strong> = 0</li><li><strong>service</strong> = MyWsService</li><li><strong>protocol</strong> = https</li><li><strong>securityMgrPlugin</strong> = mysecmgr</li><li>Add <strong>URL Authentication</strong> entry with these values: <ul><li><strong>description</strong> = &#39;Root access to service&#39;</li><li><strong>path</strong> = /</li><li><strong>resource</strong> = EnableSOAPInterface</li><li><strong>access</strong> = Read</li></ul></li><li>Add <strong>Feature Authentication</strong> entry with these values: <ul><li><strong>authenticate</strong> = Yes</li><li><strong>path</strong> = AllowMyServiceExampleMethod</li><li><strong>resource</strong> = AllowMyServiceExampleMethod</li><li><strong>description</strong> = &#39;Controls access to the ExampleMethod of WsMyService&#39;</li></ul></li><li>Add <strong>Secure User Settings</strong> entry with these values: <ul><li><strong>path</strong> = PremiumUserLevel</li><li><strong>resource</strong> = &#39;Premium User Level&#39;</li><li><strong>description</strong> = &#39;Value 1-3 indicating allowed level of premium features&#39;</li></ul></li></ul></li><li><strong>Authentication</strong> tab corresponds to the yaml file <code>authNZ</code> element</li><li><strong>AuthDomain</strong> tab corresponds to the yaml file <code>authDomain</code> element</li><li><strong>HTTPS</strong> tab corresponds to the yaml file <code>tls_config</code> element</li></ul></li></ul><p>This updates the <code>environment.xml</code> file. On startup an ESP <em>process configuration</em> named <code>esp.xml</code> is generated at <code>/var/lib/HPCCSystems/MyEspInstance/esp.xml</code> from the environment file. The <em>process configuration</em> outline looks something like this:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Software</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">EspProcess</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> daliServers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;.:7070&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;FSMA ESP configured like FSMA for auth and logging&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyEspInstance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">AuthDomains</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">AuthDomains</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">SecurityManagers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">SecurityManager</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mysecmgr&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> instanceFactoryName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> libName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyPluginSecmgrType&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">SecurityManager</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">SecurityManagers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">EspProtocol</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;secure_http_protocol&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;esphttp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">certificate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">privatekey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">privatekey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">EspProtocol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">EspService</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WsMyService&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; ... &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">EspService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">EspBinding</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WsMyService&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> protocol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;EsdlBinding&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> netAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0.0.0.0&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Authenticate</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> method</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mysecmgr&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;EnableSOAPInterface&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Read&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Root access to service&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Feature</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;AllowMyServiceExampleMethod&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;AllowMyServiceExampleMethod&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Controls access to the ExampleMethod of WsMyService&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Setting</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PremiumUserLevel&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Premium User Level&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Value 1-3 indicating allowed level of premium features&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Authenticate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">EspBinding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Authentication</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> method</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;secmgrPlugin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">EspProcess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Software</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>This deployment style requires a running dali server for the ESP process to load its <em>service bundle configurations</em> and ESDL definitions from. Refer to the <em>Dynamic ESDL</em> document on the HPCCSytems <a href="https://hpccsystems.com/training/documentation/all" target="_blank" rel="noreferrer">documentation page</a> for details on how to load the ESDL definition and the <em>service bundle configuration</em> to the dali. The <em>service bundle configuration</em> used here is the one outlined in the section <a href="#service-bundle-configuration-commonalities">Service Bundle Configuration Commonalities</a>.</p><h3 id="debugging" tabindex="-1">Debugging <a class="header-anchor" href="#debugging" aria-label="Permalink to &quot;Debugging&quot;">​</a></h3><p>The <code>Method/@traceLevel</code> attribute controls how much pre- and post- entry point debugging information is sent to the trace file. Valid values are 1-10 with 10 being the most verbose and the default being 1. Debugging information is logged for the verbose setting <code>Method/@traceLevel=10</code>:</p><ol><li>Before each entry point three elements are printed: <ol><li><code>ORIGINAL content:</code>, followed by the ESDL Script <em>source</em> context before executing any of this entry point&#39;s scripts</li><li><code>BINDING CONFIG:</code> followed by the <em>process configuration</em></li><li><code>TARGET CONFIG:</code> followed by the <em>service bundle configuration</em> section for the Method that is being executed</li></ol></li><li>After exiting each entry point the ESP prints out the contents of the ESDL Script context with the label <code>Entire script context after transforms:</code></li></ol><p>Adding <code>@trace=&quot;...&quot;</code> to any entry-point tag will include that text in error-level trace output related to that script.</p><h3 id="logging" tabindex="-1">Logging <a class="header-anchor" href="#logging" aria-label="Permalink to &quot;Logging&quot;">​</a></h3><p>TODO: Add details about configuring logging.</p><h3 id="service-security" tabindex="-1">Service Security <a class="header-anchor" href="#service-security" aria-label="Permalink to &quot;Service Security&quot;">​</a></h3><p>Keeping your DESDL service secure and ensuring proper access to product features is an important part of the process of writing and configuring your service. Basic security settings can be configured with a combination of attributes in your ESDL definition file and settings in your <em>process configuration</em>. Please refer to the separate document <a href="./README-SECURITY.html">README-SECURITY.md</a> for details.</p><p>ESDL integration scripts can assist with enforcing more complex authorization requirments. HPCC Systems platform security model has the concept of <em>Secure User Properties</em> - properties associated with a <em>Secure User</em> authenticated with an ESP. Each Security Manager plugin defines what is included in these properties, and the ESDL Scripting engine makes them available as <a href="#system-parameters">system parameters</a>.</p><p>Some of the Secure User Properties can be <em>Features</em> as described in the README-SECURITY.md file. These features can be inspected and used by a script to enforce access using these XPath functions:</p><ul><li><a href="#getfeaturesecaccessflags">getFeatureSecAccessFlags</a></li><li><a href="#secureAccessFlags">secureAccessFlags</a></li><li><a href="#validateFeaturesAccess">validateFeaturesAccess</a></li></ul><p>In addition, any of the other system parameters such as <code>$espUserStatus</code> may be used by a script to help enforce authentication or authorization.</p><h1 id="reference" tabindex="-1">Reference <a class="header-anchor" href="#reference" aria-label="Permalink to &quot;Reference&quot;">​</a></h1><p>This reference section covers details about the ESDL Scripting conventions, script entry points, script operations and supported XPath functions.</p><h2 id="conventions" tabindex="-1">Conventions <a class="header-anchor" href="#conventions" aria-label="Permalink to &quot;Conventions&quot;">​</a></h2><h3 id="implicit-variables" tabindex="-1">Implicit Variables <a class="header-anchor" href="#implicit-variables" aria-label="Permalink to &quot;Implicit Variables&quot;">​</a></h3><p>These special-case variables are implicitly defined by the scripting engine. They give scripts access to characteristics of the current transaction and context, and can be used without any prior declaration. The implicit variables are:</p><ul><li><code>method</code></li><li><code>request</code></li><li><code>service</code></li><li><code>query</code></li></ul><p>For an example we are using a simple service with one method that has a roxie backend. It is named <code>WsPersonInfo</code> with a method named <code>GetPersonInfo</code> that has an interface defined as:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>  ESPrequest GetPersonInfoRequest</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>    string FirstName;</span></span>
<span class="line"><span>    string LastName;</span></span>
<span class="line"><span>  };</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ESPresponse GetPersonInfoResponse</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>    string ResponseCode;</span></span>
<span class="line"><span>  };</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  ESPservice [version(&quot;1.0&quot;)] WsPersonInfo</span></span>
<span class="line"><span>  {</span></span>
<span class="line"><span>    ESPmethod GetPersonInfo(GetPersonInfoRequest, GetPersonInfoResponse);</span></span>
<span class="line"><span>  };</span></span></code></pre></div><p>And it is bound to the backend with this configuration:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Method</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GetPersonInfo&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://backend.roxie.com:1234&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ESDL&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> queryname</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PersonInfo_Services.GetPersonInfo&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;available&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>These are the implicit variables defined by the system:</p><ul><li><p><code>$method</code> : The name of the ESP method invoked by the current transaction request. This is derived from the <code>ESPmethod</code> name in the ESDL definition. In our example this is the string <em>GetPersonInfo</em>.</p></li><li><p><code>$request</code> : The name of the ESP request structure at the root of the current transaction request. This is derived from the <code>ESPrequest</code> name in the ESDL definition. In our example this is the string <em>GetPersonInfoRequest</em>.</p></li><li><p><code>$service</code> : The name of the service containing the current transaction&#39;s method. This is derived from the <code>ESPservice</code> name in the ESDL definition. In our example this is the string <em>WsPersonInfo</em>.</p></li><li><p><code>$query</code> : The name of the backend roxie query. This is pulled from the method configuration attribute <code>Method/@queryname</code>. In our example this is the string <em>PersonInfo_Services.GetPersonInfo</em>. Only methods configured with a <code>@queryname</code> will have this variable defined with a non-empty value.</p></li></ul><h3 id="system-parameters" tabindex="-1">System Parameters <a class="header-anchor" href="#system-parameters" aria-label="Permalink to &quot;System Parameters&quot;">​</a></h3><p>Each of these parameters gives the script access to some information about the current execution context. In order to reference a parameter, it must be declared in the script like so:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:param</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;clientversion&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;unknown&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>If the parameter is undefined, then it is assigned the value of the <code>@select</code> XPath expression. These are the available system parameters:</p><ul><li><code>$clientversion</code> : The client interface version specified in the incoming request.</li><li><code>$espUserName</code> : The username of the user authenticated to run the current transaction.</li><li><code>$espUserPeer</code> : The IP address of host originating the current transaction.</li><li><code>$espUserRealm</code> : The &#39;Company&#39; or parent entity to the currently authenticated user.</li><li><code>$espUserStatus</code> : Integer representing the status of the currently authenticated user (eg <em>Active</em>, <em>Suspended</em>, etc., as defined by the security plugin and backend in use)</li><li><code>$espUserStatusString</code> : String representing the status of the currently authenticated user (eg <em>Active</em>, <em>Suspended</em>, etc., as defined by the security plugin and backend in use)</li><li><code>$espTransactionID</code> : The transaction ID for the current in-flight transaction.</li></ul><p>These are the possible User Status values:</p><table tabindex="0"><thead><tr><th>User Status String</th><th>User Status Integer</th></tr></thead><tbody><tr><td>SecUserStatus_Inhouse</td><td>0</td></tr><tr><td>SecUserStatus_Active</td><td>1</td></tr><tr><td>SecUserStatus_Exempt</td><td>2</td></tr><tr><td>SecUserStatus_FreeTrial</td><td>3</td></tr><tr><td>SecUserStatus_csdemo</td><td>4</td></tr><tr><td>SecUserStatus_Rollover</td><td>5</td></tr><tr><td>SecUserStatus_Suspended</td><td>6</td></tr><tr><td>SecUserStatus_Terminated</td><td>7</td></tr><tr><td>SecUserStatus_TrialExpired</td><td>8</td></tr><tr><td>SecUserStatus_Status_Hold</td><td>9</td></tr><tr><td>SecUserStatus_Unknown</td><td>10</td></tr></tbody></table><p>In addition to the standard parameters above, the script engine creates parameters out of any <em>Secure User Properties</em> configured as part of the security manager plugin you&#39;re using. Each security manager may have a different behavior regarding what settings are considered <em>Secure User Properties</em>, so consult the documentation for the manager in question for that list. Scripts must include a parameter declaration for each <em>Property</em> they want available for their use.</p><h2 id="entry-points" tabindex="-1">Entry Points <a class="header-anchor" href="#entry-points" aria-label="Permalink to &quot;Entry Points&quot;">​</a></h2><p>Generally, each entry point has default source and target nodes, which are the root nodes for read and write operations respectively. These defaults can be overridden with <code>@source</code> and <code>@target</code> attributes in the entry point, which we&#39;ll discuss here, and also using <a href="#source">source</a> and <a href="#target">target</a> <a href="#operations">operations</a>.</p><p>The <code>@source</code> and <code>@target</code> attributes in the entry point elements have some special treatment not seen when they appear in operations:</p><ul><li><code>@source</code><ul><li>XPath can include any <a href="#implicit-variables">Implicit Variables</a>.</li></ul></li><li><code>@target</code><ul><li>XPath can include any <a href="#implicit-variables">Implicit Variables</a>.</li><li>XPath must exist at runtime or an exception will be thrown. <a href="https://hpccsystems.atlassian.net/browse/HPCC-25844" target="_blank" rel="noreferrer">A future release</a> will ensure the path exists without throwing an exception.</li></ul></li></ul><h3 id="backendrequest" tabindex="-1">BackendRequest <a class="header-anchor" href="#backendrequest" aria-label="Permalink to &quot;BackendRequest&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">BackendRequest</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        source</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Manipulate the ESDL request prior to submission to a backend processor. The input is the default ESDL request, which is the initial ESDL request with method context and gateway information added. The output is the final ESDL request, which may or may not differ from the default.</p><p>This is the opportunity to validate and/or modify the request before processing. Work performed in this script may include, among other things:</p><ul><li>Conditional feature authorization. Does this user have permission to submit this specifc request based on request content?</li><li>Value normalization. Correct input variances that could adversely affect the backend processor.</li><li>Data lookup. Fetch user information not defined by the securiy manager from a remote service or database.</li><li>Data updates. Add user information not supplied in the original request for the backend processor&#39;s use.</li></ul><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@name</td><td>0..1</td><td>String identifier used in trace output. Use is optional, but strongly encouraged.</td></tr><tr><td>@source</td><td>0..1</td><td>XPath expression that evaluates to an input document node. This is a shortcut to avoid a child <code>source</code> operation. Default context node is <code>esdl_request</code>.</td></tr><tr><td>@target</td><td>0..1</td><td>XPath expression that evaluates to an output document node. This is a shortcut to avoid a child <code>target</code> operation. Default XPath node is <code>final_request/$query/$request</code> when <code>$query</code> is populated. Otherwise the default XPath node is <code>final_request/$method/$request</code>.</td></tr></tbody></table><p>Is not applied to service methods with <code>@querytype</code> values:</p><ul><li>java</li><li>cpp</li><li>script</li></ul><h3 id="backendresponse" tabindex="-1">BackendResponse <a class="header-anchor" href="#backendresponse" aria-label="Permalink to &quot;BackendResponse&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">BackendResponse</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        source</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Manipulate the backend response before giving it to the ESDL transformer. The input is the original backend response. The output is the final backend response, which may or may not differ from the original.</p><p>This is the opportunity to manipulate all response data without regard for request versioning and optionals. After completing these entry point scripts, the ESDL transformer will enforce response compliance to the WSDL.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@name</td><td>0..1</td><td>String identifier used in trace output. Use is optional, but strongly encouraged.</td></tr><tr><td>@source</td><td>0..1</td><td>XPath expression that evaluates to an input document node. This is a shortcut to avoid a child <code>source</code> operation. Default context node is <code>initial_response</code>.</td></tr><tr><td>@target</td><td>0..1</td><td>XPath expression that evaluates to an output document node. This is a shortcut to avoid a child <code>target</code> operation. Default context node is <code>pre_esdl_response</code>.</td></tr></tbody></table><p>Is not applied to service methods with <code>@querytype</code> values:</p><ul><li>java</li><li>cpp</li></ul><h3 id="esdlresponse" tabindex="-1">EsdlResponse <a class="header-anchor" href="#esdlresponse" aria-label="Permalink to &quot;EsdlResponse&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">EsdlResponse</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        source</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Manipulate the ESP response before returning it to the user. The input is the original ESP response, which is the output of the ESDL transformer. The output is the final ESP response, which may or may not differ from the original.</p><p>This is the opportunity to manipulate the user response based on what is actually present in the user response. It should only be used when a manipulation requires the original ESP response to complete. If present, the response will be processed by the ESDL transformer twice - once to construct the initial response and again to ensure the final response conforms to the WSDL.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@name</td><td>0..1</td><td>String identifier used in trace output. Use is optional, but strongly encouraged.</td></tr><tr><td>@source</td><td>0..1</td><td>XPath expression that evaluates to an input document node. This is a shortcut to avoid a child <code>source</code> operation. Default context node is <code>initial_esdl_response</code>.</td></tr><tr><td>@target</td><td>0..1</td><td>XPath expression that evaluates to an output document node. This is a shortcut to avoid a child <code>target</code> operation. Default context node is <code>modified_esdl_response</code>.</td></tr></tbody></table><p>Is not applied to service methods with <code>@querytype</code> values:</p><ul><li>java</li><li>cpp</li></ul><h3 id="prelogging" tabindex="-1">PreLogging <a class="header-anchor" href="#prelogging" aria-label="Permalink to &quot;PreLogging&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">PreLogging</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        source</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Manipulate the complete script context after a response is returned to the user. Changes made to the document at this point will be reflected in the data made available for logging. The inputs are the non-result datasets returned by the backend, available at the context location <code>logdata/LogDatasets</code>. Anything written into the <code>logdata</code> section will be part of the payload passed on the LogManager.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@name</td><td>0..1</td><td>String identifier used in trace output. Use is optional, but strongly encouraged.</td></tr><tr><td>@source</td><td>0..1</td><td>XPath expression that evaluates to an input document node. This is a shortcut to avoid a child <code>source</code> operation. Default context node is <code>logdata</code></td></tr><tr><td>@target</td><td>0..1</td><td>XPath expression that evaluates to an output document node. This is a shortcut to avoid a child <code>target</code> operation. Default context node is <code>logdata</code>.</td></tr></tbody></table><p>Is not applied to service methods with <code>@querytype</code> values:</p><ul><li>java</li><li>cpp</li></ul><h3 id="service" tabindex="-1">Service <a class="header-anchor" href="#service" aria-label="Permalink to &quot;Service&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Service</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        source</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Perform the service method request action, replacing the call to a backend server. This entry point is invoked for methods with a <code>@querytype</code> value of <code>script</code>. The input is the initial ESDL request, i.e., the output of the ESDL transformer operating on the ESP request. The output document begins as an empty ESP response.</p><p>When using this entry point the BackendRequest and BackendResponse entry points aren&#39;t executed. All other entry points are processed when present and all normal ESDL transformer runs are applied.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@name</td><td>0..1</td><td>String identifier used in trace output. Use is optional, but strongly encouraged.</td></tr><tr><td>@source</td><td>0..1</td><td>XPath expression that evaluates to an input document node. This is a shortcut to avoid a child <code>source</code> operation. Default context node is <code>script_request</code>.</td></tr><tr><td>@target</td><td>0..1</td><td>XPath expression that evaluates to an output document node. This is a shortcut to avoid a child <code>target</code> operation. Default context node is <code>script_response</code>.</td></tr></tbody></table><p>Is not applied to service methods with <code>@querytype</code> values:</p><ul><li>java</li><li>cpp</li><li>roxie</li><li>wsecl</li><li>proxy</li></ul><h2 id="xpath" tabindex="-1">XPath <a class="header-anchor" href="#xpath" aria-label="Permalink to &quot;XPath&quot;">​</a></h2><p>ESDL Integration Scripting supports XPath 1.0. Any attributes that accept XPaths may use the functions described in this section unless otherwise noted. Refer to the <a href="https://www.w3.org/TR/1999/REC-xpath-19991116/" target="_blank" rel="noreferrer">XPath 1.0 spec</a> for the definitive explanation of available features.</p><h3 id="variable-resolution" tabindex="-1">Variable Resolution <a class="header-anchor" href="#variable-resolution" aria-label="Permalink to &quot;Variable Resolution&quot;">​</a></h3><p>Variables in XPath are referenced by prepending a <code>$</code> to the variable&#39;s name. Any variables or parameters defined in an ESDL Script can be used in XPaths in that script.</p><p>With the exceptions noted in the <a href="#extensions">Extensions</a> section, variables can be used only as allowed in the XPath spec. In the terms used in the spec a variable can&#39;t be used as an <em>Axis</em> to identify a node in a <em>Location Path</em>. A variable can only appear in an <em>Expression</em>, function <em>Argument</em> or in a <em>Predicate</em> section of a <em>Location Path</em>. Examples below will illustrate these different cases.</p><p>This sample XML will be our source context for the examples:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">foo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">bar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">do</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;deer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;a deer&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">do</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;doe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;a female deer&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;sunlight&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;a name&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;call myself&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">bar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">foo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>And say we have these ESDL Script variables defined:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:variable</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;barVar&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;bar&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:variable</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;twoVar&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:variable</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;deerVar&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;deer&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><h4 id="location-paths-and-predicates" tabindex="-1">Location Paths and Predicates <a class="header-anchor" href="#location-paths-and-predicates" aria-label="Permalink to &quot;Location Paths and Predicates&quot;">​</a></h4><p>This XPath shows incorrect use of a variable as an <em>Axis</em> of a <em>Location Path</em> to select the node <code>ray</code>.</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;result&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo/$barVar/ray&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>This XPath fails to properly resolve.</p><p>To achieve the same thing, we can use a <em>Predicate</em> to select any node whose local name (the name without using namespaces) is <code>bar</code>:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;result&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo/*[local-name()=$barVar]/ray&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Yielding:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;sunlight&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Similarly, we can use a predicate to select the second occurrence of the <code>mi</code> node:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;result&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo/bar/mi[$twoVar]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>Yielding:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;call myself&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Or we could use a predicate to select the <code>do</code> node with a <code>name</code> attribute equal to <em>deer</em>:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;result&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo/bar/do[@name=$deerVar]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>Yielding:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;a female deer&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h4 id="expressions-and-function-arguments" tabindex="-1">Expressions and Function Arguments <a class="header-anchor" href="#expressions-and-function-arguments" aria-label="Permalink to &quot;Expressions and Function Arguments&quot;">​</a></h4><p>Variables can also be referenced in <em>Expressions</em> and in function <em>Arguments</em>. At its simplest an <em>Expression</em> can be a variable reference. This example shows setting the <code>result</code> node to the value of a <code>deerVar</code>:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;result&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$deerVar&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>Yields this:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;deer&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>This more complex expression with a variable:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;result&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$twoVar + 10&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>Yields:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;12&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Variables can also be referenced in <em>Arguments</em> to functions:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;result&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string-length($deerVar) + 10&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>Yielding:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;14&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h3 id="extensions" tabindex="-1">Extensions <a class="header-anchor" href="#extensions" aria-label="Permalink to &quot;Extensions&quot;">​</a></h3><p>ESDL Scripts extend standard XPath features to make setting entry point default <code>@source</code> and <code>@target</code> nodes easier. In any entry point element, the <code>@source</code> and <code>@target</code> XPaths may contain the <a href="#implicit-variables">Implicit Variables</a> as <em>Axes</em>. These special variable references are wrapped in curly braces.</p><p>For example, say we have the following simplified request bound for a roxie backend that we&#39;re going to manipulate with a <code>BackendRequest</code> entry point script:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:soap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">MyMethodModule.MyMethodQuery</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">MyMethodRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">MyMethodRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">MyMethodModule.MyMethodQuery</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>The goal is to have a single script for a service that adds several nodes to the <code>Options</code> section for every method in the service. Each method has a different roxie query name (here <code>MyMethodModule.MyMethodQuery</code>) and different method request name (here <code>MyMethodRequest</code>). This script will correctly set the default target for all methods:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:BackendRequest</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SetServiceOptions&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                   target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;soap:Body/{$query}/{$request}/Row/Options&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                   xmlns:soap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:es</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpcc:esdl:script&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;AccessLevel&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;FeatureSet&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;all&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:BackendRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Resulting in this request sent to the roxie:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:soap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">MyMethodModule.MyMethodQuery</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">MyMethodRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">AccessLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;1&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">AccessLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">FeatureSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;all&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">FeatureSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">MyMethodRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">MyMethodModule.MyMethodQuery</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h3 id="namespaces" tabindex="-1">Namespaces <a class="header-anchor" href="#namespaces" aria-label="Permalink to &quot;Namespaces&quot;">​</a></h3><p>The scripting engine requires correct use of namespaces. A frequent source of scripting errors is omitting namespaces where they&#39;re required or using an incorrect namespace or namespace prefix. Namespaces must match between the context XML document and script XPaths referencing the context XML document. It is not required for the prefix in the script&#39;s XPath to match the prefix in the document.</p><p>In most cases this means that a script needs to define matching namespace URIs. There are two exceptions:</p><ol><li>The engine will automatically detect and define the standard soap namespace ( <code>xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</code> ) with the prefix <code>soap</code> if you use an XPath that incudes <code>Body</code> or <code>Envelope</code> nodes.</li><li>The prefix <code>n</code> is defined to refer to the current default namespace (a namespace with no prefix), and it can be used in script XPaths if desired.</li></ol><p>For the examples below, say we have this source XML:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">request</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://foo.bar.com:9876&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:soap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">country</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;us&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">country</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">special_services.my_service</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpccsystems:ecl:special_services.my_service&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">city</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;minneapolis&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">city</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;mn&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">zip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;55419&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">zip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">nested</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpccsystems:ecl:special_services.my_service:nested&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">phone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;6125551212&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">phone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">nested</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">special_services.my_service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h4 id="soap-example" tabindex="-1">soap Example <a class="header-anchor" href="#soap-example" aria-label="Permalink to &quot;soap Example&quot;">​</a></h4><p>Say we are processing a BackendRequest script. Knowing the special handling of the soap namespace we could write a script as below to refer to the <code>country</code> node:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">BackendRequest</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TestScript&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:es</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpcc:esdl:script&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:variable</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;country-value&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;request/content/soap:Envelope/soap:Body/country&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">BackendRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h4 id="default-namespace-examples" tabindex="-1">Default Namespace Examples <a class="header-anchor" href="#default-namespace-examples" aria-label="Permalink to &quot;Default Namespace Examples&quot;">​</a></h4><p>To refer to the <code>city</code> node in the example using the special default prefix <code>n</code>, the script would look like this:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">BackendRequest</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TestScript&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                xmlns:es</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpcc:esdl:script&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                xmlns:soap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:variable</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;city-value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                 select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;request/content/soap:Envelope/soap:Body/n:special_services.my_service/n:city&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">BackendRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Alternately you can define the namespace with a prefix and use that prefix in your XPath:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">BackendRequest</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TestScript&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                xmlns:es</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpcc:esdl:script&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                xmlns:soap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                xmlns:insvc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpccsystems:ecl:special_services.my_service&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:variable</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;city-value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                 select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;request/content/soap:Envelope/soap:Body/insvc:special_services.my_service/insvc:city&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">BackendRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>The special default prefix <code>n</code> is only valid for the first default namespace encountered in an XPath. To refer to the <code>phone</code> node above, you could use an XPath like this:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">BackendRequest</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TestScript&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                xmlns:es</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpcc:esdl:script&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                xmlns:soap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                xmlns:spnest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpccsystems:ecl:special_services.my_service:nested&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:variable</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;city-value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                 select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;request/content/soap:Envelope/soap:Body/n:special_services.my_service/spnest:nested/spnest:phone&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">BackendRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h3 id="exslt-functions" tabindex="-1">EXSLT Functions <a class="header-anchor" href="#exslt-functions" aria-label="Permalink to &quot;EXSLT Functions&quot;">​</a></h3><p>In addition to the spec XPath functions, we support a subset of EXSLT-Functions (Extended XSLT) for use in XPath expressions. The exslt functions are grouped into modules of related features like <em>strings</em>, <em>sets</em> and <em>math</em>. There are different implmentations of the modules and not all implementations support all functions. We are using the <code>libxslt</code> implementation. The reference at <a href="https://exslt.github.io/func/index.html" target="_blank" rel="noreferrer">exslt.github.io</a> lists the functions in each module and which implementations support each function. See below for details of our supported modules</p><table tabindex="0"><thead><tr><th>Module Name</th><th>Namespace Prefix</th><th>libxslt Supported Functions</th></tr></thead><tbody><tr><td><a href="http://exslt.github.io/date/index.html" target="_blank" rel="noreferrer">dates and times</a></td><td>date</td><td>all except <code>date:format-date</code>, <code>date:parse-date</code>, <code>date:sum</code>, <code>date:date-format</code></td></tr><tr><td><a href="http://exslt.github.io/math/index.html" target="_blank" rel="noreferrer">math</a></td><td>math</td><td>all</td></tr><tr><td><a href="http://exslt.github.io/set/index.html" target="_blank" rel="noreferrer">sets</a></td><td>set</td><td>all except <code>set:distinct</code></td></tr><tr><td><a href="http://exslt.github.io/str/index.html" target="_blank" rel="noreferrer">strings</a></td><td>str</td><td>all except <code>str:decode-uri</code>, <code>str:encode-uri</code>, <code>str:replace</code>, <code>str:split</code></td></tr></tbody></table><h3 id="custom-functions" tabindex="-1">Custom Functions <a class="header-anchor" href="#custom-functions" aria-label="Permalink to &quot;Custom Functions&quot;">​</a></h3><p>ESDL Integration Scripting defines several custom XPath functions described below.</p><h4 id="ensuredatasection" tabindex="-1">ensureDataSection <a class="header-anchor" href="#ensuredatasection" aria-label="Permalink to &quot;ensureDataSection&quot;">​</a></h4><pre><code>node-set ensureDataSection(section_name)
</code></pre><p>Ensures the script context section named <em>section_name</em> exists and returns it as a node-set. Returns an empty node set if the XPath evaluation of <em>section_name</em> fails.</p><table tabindex="0"><thead><tr><th>Parameter</th><th>Required?</th><th>Description</th></tr></thead><tbody><tr><td>section_name</td><td>no</td><td>XPath expression evaluating to the name of the context section to act on. If omitted, defaults to <code>temporaries</code>.</td></tr></tbody></table><h5 id="example" tabindex="-1">Example <a class="header-anchor" href="#example" aria-label="Permalink to &quot;Example&quot;">​</a></h5><p>Start with the script context in this state:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_script_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_script_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Execute this entry point script:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:BackendRequest</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:es</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpcc:esdl:script&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ensureDataSection(&#39;mySection&#39;)/firstValue&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;23&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:BackendRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Result is this script context:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_script_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mySection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">firstValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;23&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">firstValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mySection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">final_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">final_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_script_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h4 id="getdatasection" tabindex="-1">getDataSection <a class="header-anchor" href="#getdatasection" aria-label="Permalink to &quot;getDataSection&quot;">​</a></h4><pre><code>node-set getDataSection(section_name)
</code></pre><p>Returns the node-set of the xml node named <em>section_name</em> of the script context. Returns an empty node-set if the XPath evaluation of <em>section_name</em> fails.</p><table tabindex="0"><thead><tr><th>Parameter</th><th>Required?</th><th>Description</th></tr></thead><tbody><tr><td>section_name</td><td>no</td><td>XPath expression evaluating to the name of the context section to retrieve. If omitted, defaults to <code>temporaries</code>.</td></tr></tbody></table><h5 id="example-1" tabindex="-1">Example <a class="header-anchor" href="#example-1" aria-label="Permalink to &quot;Example&quot;">​</a></h5><p>Assume we have this script context</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_script_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mySection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">firstValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;23&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">firstValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mySection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">final_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">final_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_script_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>then execute this entry point script:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:BackendRequest</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xmlns:es</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpcc:esdl:script&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyFirstValue&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;getDataSection(&#39;mySection&#39;)/firstValue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:BackendRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>The resulting script context is:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_script_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mySection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">firstValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;23&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">firstValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mySection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">final_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">MyFirstValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;23&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">MyFirstValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">final_request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_script_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h4 id="getfeaturesecaccessflags" tabindex="-1">getFeatureSecAccessFlags <a class="header-anchor" href="#getfeaturesecaccessflags" aria-label="Permalink to &quot;getFeatureSecAccessFlags&quot;">​</a></h4><pre><code>number getFeatureSecAccessFlags(feature_name)
</code></pre><p>Returns the internal representation of the access granted to the authenticated ESP user for the indicated feature resource.</p><table tabindex="0"><thead><tr><th>Parameter</th><th>Required?</th><th>Description</th></tr></thead><tbody><tr><td>feature_name</td><td>no</td><td>XPath expression evaluating to the name of a defined feature resource.</td></tr></tbody></table><p>These are the numeric values returned associated with the different access levels:</p><table tabindex="0"><thead><tr><th>Number</th><th>Access Level Name</th></tr></thead><tbody><tr><td>-1</td><td>Unavailable</td></tr><tr><td>-255</td><td>Unknown</td></tr><tr><td>0</td><td>None</td></tr><tr><td>1</td><td>Access</td></tr><tr><td>3</td><td>Read</td></tr><tr><td>7</td><td>Write</td></tr><tr><td>255</td><td>Full</td></tr></tbody></table><h4 id="getlogoption" tabindex="-1">getLogOption <a class="header-anchor" href="#getlogoption" aria-label="Permalink to &quot;getLogOption&quot;">​</a></h4><pre><code>string getLogOption(option)
</code></pre><p>Determines if a named log option has been set. If set, the option value is returned. If not set, returns an empty string.</p><p>In the context of log agents and their variant identifiers, a log option generally corresponds to a variant type identifier. It is acceptable to set options that are not agent type identifiers.</p><table tabindex="0"><thead><tr><th>Parameter</th><th>Required?</th><th>Description</th></tr></thead><tbody><tr><td>feature_name</td><td>no</td><td>XPath expression evaluating to the name of a log option.</td></tr></tbody></table><h4 id="getlogprofile" tabindex="-1">getLogProfile <a class="header-anchor" href="#getlogprofile" aria-label="Permalink to &quot;getLogProfile&quot;">​</a></h4><pre><code>string getLogProfile()
</code></pre><p>Determines if a log profile has been set. If set, the profile name is returned. If not set, returns an empty string.</p><p>In the context of log agents and their variant identifiers, the log profile corresponds to a variant group identifier.</p><h4 id="getstoredstringvalue" tabindex="-1">getStoredStringValue <a class="header-anchor" href="#getstoredstringvalue" aria-label="Permalink to &quot;getStoredStringValue&quot;">​</a></h4><pre><code>string getStoredStringValue(value_name)
</code></pre><p>Determines if a named value has been added to the script context&#39;s <code>store</code> section. Returns the value if it exists. Returns an empty string if it does not exist.</p><table tabindex="0"><thead><tr><th>Parameter</th><th>Required?</th><th>Description</th></tr></thead><tbody><tr><td>value_name</td><td>yes</td><td>XPath expression evaluating to the name of a stored string value.</td></tr></tbody></table><h4 id="logoptionexists" tabindex="-1">logOptionExists <a class="header-anchor" href="#logoptionexists" aria-label="Permalink to &quot;logOptionExists&quot;">​</a></h4><pre><code>boolean logOptionExists(option_name)
</code></pre><p>Determines if a named log option has been set. Returns <em>true</em> if set. Returns <em>false</em> if not set.</p><p>In the context of log agents and their variant identifiers, a log option generally corresponds to a variant type identifier. It is acceptable to set options that are not agent type identifiers.</p><table tabindex="0"><thead><tr><th>Parameter</th><th>Required?</th><th>Description</th></tr></thead><tbody><tr><td>option_name</td><td>yes</td><td>XPath expression evaluating to the name of a log option.</td></tr></tbody></table><h4 id="secureaccessflags" tabindex="-1">secureAccessFlags <a class="header-anchor" href="#secureaccessflags" aria-label="Permalink to &quot;secureAccessFlags&quot;">​</a></h4><pre><code>number secureAccessFlags(access-level-1, ..., access-level-n)
</code></pre><p>Returns a bit-mask containing the internal representations of each given access level.</p><table tabindex="0"><thead><tr><th>Parameter</th><th>Required?</th><th>Description</th></tr></thead><tbody><tr><td>access-level-1</td><td>yes</td><td>The text representation of a defined resource access level. One value is required.</td></tr><tr><td>access-level-2 ... access-level-n</td><td>no</td><td>The text representation of a defined resource access level.</td></tr></tbody></table><p>The defined access level strings are:</p><ul><li>Unavailable</li><li>None</li><li>Access</li><li>Read</li><li>Write</li><li>Full</li></ul><h4 id="storedvalueexists" tabindex="-1">storedValueExists <a class="header-anchor" href="#storedvalueexists" aria-label="Permalink to &quot;storedValueExists&quot;">​</a></h4><pre><code>boolean storedValueExists(value_name)
</code></pre><p>Determines if a named value exists in the script context&#39;s <code>store</code> section. Returns <em>true</em> if the name exists. Returns <em>false</em> if the name does not exist.</p><table tabindex="0"><thead><tr><th>Parameter</th><th>Required?</th><th>Description</th></tr></thead><tbody><tr><td>value_name</td><td>yes</td><td>XPath expression evaluating to the name of a stored string value.</td></tr></tbody></table><h4 id="tokenize" tabindex="-1">tokenize <a class="header-anchor" href="#tokenize" aria-label="Permalink to &quot;tokenize&quot;">​</a></h4><pre><code>node-set tokenize(string)
node-set tokenize(string, delimiters)
</code></pre><p>Breaks an input text string into tokens based on delimiters. The tokens are temporarily added to the script context as individual nodes which can be used by script operations that act on node-sets.</p><table tabindex="0"><thead><tr><th>Parameter</th><th>Required?</th><th>Description</th></tr></thead><tbody><tr><td>string</td><td>yes</td><td>Text string possibly containing delimited text to be split into tokens.</td></tr><tr><td>delimiters</td><td>no</td><td>Optional set of characters used to split <em>string</em> into tokens. Defaults to tab, carriage return, line feed, and space, if omitted.</td></tr></tbody></table><h4 id="example-2" tabindex="-1">Example <a class="header-anchor" href="#example-2" aria-label="Permalink to &quot;Example&quot;">​</a></h4><p>This script:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:element</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;NewNode&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:copy-of</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tokenize(&#39;a,b,c,d&#39;, &#39;,&#39;)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Will give this result in the target:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">NewNode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;a&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;b&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;c&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;d&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">NewNode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h4 id="validatefeaturesaccess" tabindex="-1">validateFeaturesAccess <a class="header-anchor" href="#validatefeaturesaccess" aria-label="Permalink to &quot;validateFeaturesAccess&quot;">​</a></h4><pre><code>boolean validateFeatureAccess(access_list)
</code></pre><p>Returns <em>true</em> if the authenticated ESP user has been granted the minimum required access for each requested feature. Returns <em>false</em> if the authenticated ESP user has not been granted the minimum required access for at least one requested feature.</p><table tabindex="0"><thead><tr><th>Parameter</th><th>Required?</th><th>Description</th></tr></thead><tbody><tr><td>access_list</td><td>yes</td><td>A comma-delimited string of access tokens. Each access tokens takes the form of <code>feature-name [ &#39;:&#39; access-level ]</code>, where <code>feature-name</code> is the name of a defined feature resource and <code>access-level</code> is the required permission level. If <code>access-level</code> is omitted, <em>READ</em> access is required.</td></tr></tbody></table><h2 id="operations" tabindex="-1">Operations <a class="header-anchor" href="#operations" aria-label="Permalink to &quot;Operations&quot;">​</a></h2><h3 id="add-value" tabindex="-1">add-value <a class="header-anchor" href="#add-value" aria-label="Permalink to &quot;add-value&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">add-value</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath evaluated as string&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        xpath_target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath evaluated as string&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Given an output destination XPath, add a new occurrence of the path&#39;s leaf element, building the path&#39;s elements along the way. The path to the leaf must be uniquely identified, but the leaf itself may be repeated any number of times.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@name</td><td>0..1</td><td>Alternate value for trace output when <code>@trace</code> is empty. This exists for backward compatibility.</td></tr><tr><td>@required</td><td>0..1</td><td>Boolean flag indicating whether a failure to traverse the path to the leaf yields an exception (<em>true</em>) or silent failure (<em>false</em>).</td></tr><tr><td>@select</td><td>0..1</td><td>XPath expression evaluated to produce the new element&#39;s value.</td></tr><tr><td>@target</td><td>0..1</td><td>XPath for the element to be created, if <code>@xpath_target</code> is omitted.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@value</td><td>0..1</td><td>The new element&#39;s value, if <code>@select</code> is omitted.</td></tr><tr><td>@xpath_target</td><td>0..1</td><td>XPath expression evaluated to an XPath identifying the element to be added.</td></tr></tbody></table><ul><li>While <code>target</code> and <code>xpath_target</code> are individually optional, at least one must be given. If both are given, <code>xpath_target</code> is used.</li><li>While <code>select</code> and <code>value</code> are individually optional, at least one must be given. If both are given, <code>select</code> is used.</li></ul><h3 id="append-to-value" tabindex="-1">append-to-value <a class="header-anchor" href="#append-to-value" aria-label="Permalink to &quot;append-to-value&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">append-to-value</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath evaluated as string&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        xpath_target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath evaluated as string&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Given an output destination XPath, add a new element with the given value, if one does not already exist, or append the given value to the existing element value. The path must uniquely identify an element to be created or updated.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@name</td><td>0..1</td><td>Alternate value for trace output when <code>@trace</code> is empty. This exists for backward compatibility.</td></tr><tr><td>@required</td><td>0..1</td><td>Boolean flag indicating whether a failure to traverse the path to the leaf yields an exception (<em>true</em>) or silent failure (<em>false</em>).</td></tr><tr><td>@select</td><td>0..1</td><td>XPath expression evaluated to produce the new value content.</td></tr><tr><td>@target</td><td>0..1</td><td>XPath for the element to be updated or created, if <code>@xpath_target</code> is omitted.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@value</td><td>0..1</td><td>The element content update, if <code>@select</code> is omitted.</td></tr><tr><td>@xpath_target</td><td>0..1</td><td>XPath expression evaluated to an XPath identifying the element to be updated or created.</td></tr></tbody></table><ul><li>While <code>target</code> and <code>xpath_target</code> are individually optional, at least one must be given. If both are given, <code>xpath_target</code> is used.</li><li>While <code>select</code> and <code>value</code> are individually optional, at least one must be given. If both are given, <code>select</code> is used.</li></ul><p><em>For backward compatibility, <code>AppendValue</code> is an accepted synonym for this operation, though we discourgae its use.</em></p><h3 id="assert" tabindex="-1">assert <a class="header-anchor" href="#assert" aria-label="Permalink to &quot;assert&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">assert</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath integer expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath text expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;text value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath Boolean expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Terminate transaction processing with an error code and message when <code>@test</code> evaluates to <em>false</em>.</p><blockquote><p><strong>Caution</strong>: Available to any <em>entry point</em>, the operation&#39;s purpose is to short circuit transaction processing before submitting a request to the backend processor. It is likely inappropriate to short circuit processing once the backend processor has produced a result or logging is required.</p></blockquote><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@code</td><td>1..1</td><td>XPath expression that evaluates to an integer. The integer becomes the error code in a thrown exception.</td></tr><tr><td>@message</td><td>1..1</td><td>XPath expression that evaluates to text. The text becomes the error message in a thrown exception.</td></tr><tr><td>@name</td><td>0..1</td><td>Text label used only when <code>@trace</code> is absent.</td></tr><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@test</td><td>1..1</td><td>XPath expression that evaluates to a Boolean. Throw an exception if <em>true</em>. Do nothing if <em>false</em>.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr></tbody></table><p>The operation supports no child operations.</p><h3 id="choose" tabindex="-1">choose <a class="header-anchor" href="#choose" aria-label="Permalink to &quot;choose&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">choose</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">when</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath Boolean expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">otherwise</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">choose</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Selects at most one child to be processed. Each <code>when/@test</code> condition is evaluated, in defined order. If evaluation yields <em>true</em>, that clause&#39;s child operations are processed and this operation terminates. If no evaluation yields <em>true</em> and an <code>otherwise</code> clause is present, the children of <code>otherwise</code> are processed and this operation terminates.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>when</td><td>0..n</td><td>An operation block to be processed if its <code>@test</code> expression evaluates to <em>true</em>, and to be ignored if its <code>@test</code> expression evaluates to <em>false</em>.</td></tr><tr><td>otherwise</td><td>0..1</td><td>An operation block to be processed if no occurrence of <code>when</code> is processed.</td></tr></tbody></table><ul><li>While <code>when</code> and <code>otherwise</code> are both optional on their own, at least one of either is required. Both are operation blocks capable of containing operations.</li><li>Child elements other than <code>when</code> and <code>otherwise</code> are silently ignored during load. Parsing succeeds, but runtime outcome will not be as expected.</li></ul><h3 id="copy-of" tabindex="-1">copy-of <a class="header-anchor" href="#copy-of" aria-label="Permalink to &quot;copy-of&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">copy-of</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        new_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node-set value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Creates copies of selected nodes, optionally renaming them, and adds them to the current target node.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@new_name</td><td>0..1</td><td>Node name assigned to copies. If empty, copies are not renamed.</td></tr><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@select</td><td>1..1</td><td>Path to nodes to be copied.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr></tbody></table><ul><li>This operation contains no child operations.</li></ul><h3 id="element" tabindex="-1">element <a class="header-anchor" href="#element" aria-label="Permalink to &quot;element&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">element</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        namespace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Add an element to the current target node with the given name. Any child operations use the new element as their default target.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@name</td><td>1..1</td><td>Valid XML element name.</td></tr><tr><td>@namespace</td><td>0..1</td><td>Reserved for future use.</td></tr><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr></tbody></table><h3 id="ensure-target" tabindex="-1">ensure-target <a class="header-anchor" href="#ensure-target" aria-label="Permalink to &quot;ensure-target&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ensure-target</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        xpath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Temporarily change the script&#39;s current target to an existing or new output document node. Relative paths specified in child operations are relative to the indicated node. The effective target resets to its previous value upon completion of child processing.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>true</em>.</td></tr><tr><td>@required</td><td>0..1</td><td>Boolean flag indicating whether a failure to uniquely identify an existing output node terminates processing (<em>true</em>) or skips processing child operations (<em>false</em>). Defaults to <em>true</em>.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@xpath</td><td>1..1</td><td>XPath expression evaluating to document node. If that node does not exist it is created.</td></tr></tbody></table><p>See also <a href="#if-target">if-target</a> and <a href="#target">target</a>.</p><h3 id="fail" tabindex="-1">fail <a class="header-anchor" href="#fail" aria-label="Permalink to &quot;fail&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">fail</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath integer expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath text expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;text value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Terminate transaction processing with an error code and message.</p><blockquote><p><strong>Caution</strong>: Available to any <em>entry point</em>, the operation&#39;s purpose is to short circuit transaction processing before submitting a request to the backend processor. It is likely inappropriate to short circuit processing once the backend processor has produced a result or logging is required.</p></blockquote><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@code</td><td>1..1</td><td>XPath expression that evaluates to an integer. The integer becomes the error code in a thrown exception.</td></tr><tr><td>@message</td><td>1..1</td><td>XPath expression that evaluates to text. The text becomes the error message in a thrown exception.</td></tr><tr><td>@name</td><td>0..1</td><td>Text label used only when <code>@trace</code> is absent.</td></tr><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr></tbody></table><p>The operation supports no child operations.</p><h3 id="for-each" tabindex="-1">for-each <a class="header-anchor" href="#for-each" aria-label="Permalink to &quot;for-each&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">for-each</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node-set expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Iterates a possibly empty set of input nodes. Child operations are processed once for each node, with the selected node as the current source node.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@select</td><td>1..1</td><td>XPath expression that identifying all input nodes to be iterated.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr></tbody></table><h3 id="http-post-xml" tabindex="-1">http-post-xml <a class="header-anchor" href="#http-post-xml" aria-label="Permalink to &quot;http-post-xml&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">http-post-xml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        section</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">http-header</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                     xpath_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath string expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                     value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath string expression&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">http-post-xml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Create then send an HTTP post message with XML content. Content type of the outgoing request is <code>text/xml</code>.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@url</td><td>1..1</td><td>Endpoint to send the HTTP post message.</td></tr><tr><td>@section</td><td>0..1</td><td>Path to the section of script context where output is placed. If omitted defaults to <code>temporaries</code>.</td></tr><tr><td>@name</td><td>1..1</td><td>Name of the node inside <code>@section</code> where the output is placed. If it does not exist it is created.</td></tr><tr><td>http-header</td><td>0..n</td><td>An HTTP Header name and value to include with the POST. Use one element for each header</td></tr><tr><td>http-header/@name</td><td>0..1</td><td>String value giving the name of the HTTP header.</td></tr><tr><td>http-header/@xpath-name</td><td>0..1</td><td>XPath expression evaluated as a string giving the name of the HTTP header.</td></tr><tr><td>http-header/@value</td><td>1..1</td><td>The value of the HTTP header.</td></tr><tr><td>content</td><td>1..1</td><td>Contains child script operations that construct the XML payload of the HTTP Post.</td></tr></tbody></table><p>Note:</p><ul><li>While <code>http-header/@name</code> and <code>http-header/@xpath-name</code> are individually optional, at least one is required. If both are provided then <code>@xpath-name</code> is used.</li><li>Child elements other than <code>http-header</code> and <code>content</code> are ignored.</li><li>Multiple <code>http-header</code> child elements can be used.</li><li>Only one <code>content</code> child element should be used. If multiple are present the last one in lexical order is used.</li></ul><p>On completion of the HTTP transaction, the script context is updated as below:</p><ul><li><em><code>section</code></em><code>/</code><em><code>name</code></em><code>/request/content</code> holds the constructed request</li><li><em><code>section</code></em><code>/</code><em><code>name</code></em><code>/response</code> holds the HTTP response</li><li><em><code>section</code></em><code>/</code><em><code>name</code></em><code>/response/@status</code> holds the HTTP response status</li><li><em><code>section</code></em><code>/</code><em><code>name</code></em><code>/response/@error-code</code> holds the HTTP response error code, zero indicating success</li><li><em><code>section</code></em><code>/</code><em><code>name</code></em><code>/response/@content-type</code> holds the <em>Content-Type</em> header value of the HTTP response</li></ul><h4 id="example-3" tabindex="-1">Example <a class="header-anchor" href="#example-3" aria-label="Permalink to &quot;Example&quot;">​</a></h4><p>Say we have an ESDL Script that calls out to a roxie to get a <em>userid</em> number prior to logging. In this example we&#39;re hard-coding values for the outgoing request, but in a actual script those values would likely be copied from another location of the script context.</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:PreLogging</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;LogPrep&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                 xmlns:es</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpcc:esdl:script&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                 xmlns:soap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                 xmlns:svc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpccsystems:ecl:misc_services.log_service&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                 xmlns:resp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpccsystems:ecl:misc_services.log_service:result:results&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:http-post-xml</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;http://roxie.my.domain:9876&#39;&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                      section</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;logdata/LogDatasets&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                      name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;LogPrep&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:element</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Envelope&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> prefix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;soap&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        uri</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        current</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;true&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:element</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Body&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:element</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;misc_services.log_service&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> uri</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;urn:hpccsystems:ecl:misc_services.log_service&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                            current</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;true&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;FirstName&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;John&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:set-value</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;LastName&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;Baker&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:http-post-xml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!--</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        Pull userid from roxie response to use in subsequent processing</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:variable</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;userid&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;getDataSection(&#39;logdata&#39;)/LogDatasets/LogPrep/response/content/soap:Envelope/soap:Body/svc:misc_services.log_serviceResponse/svc:Results/svc:Result/resp:Dataset/resp:Row/resp:userid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:PreLogging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>After executing this script, and assuming a successful POST to the roxie, the script context would look like this:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_script_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">logdata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">LogDatasets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">LogPrep</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> content-type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;text/xml&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;OK&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               status-code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">svc:misc_services.log_service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">svc:FirstName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;John&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">svc:FirstName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">svc:LastName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Baker&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">svc:LastName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">svc:misc_services.log_serviceResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">svc:Results</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">svc:Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">resp:Dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">resp:Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">resp:userid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;1234&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">resp:userid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">resp:Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">resp:Dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">svc:Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">svc:Results</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">svc:misc_services.log_serviceResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">soap:Envelope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">LogPrep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">LogDatasets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">logdata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">esdl_script_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>This example also shows how correct namespaces must be declared in an entry point if any operations will refer to nodes using those namespaces.</p><h3 id="if" tabindex="-1">if <a class="header-anchor" href="#if" aria-label="Permalink to &quot;if&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">if</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath Boolean expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Evaluates <code>@test</code> to decide whether child operations are or are not processed. An evaluated result of <em>true</em> processes children, and a result of <em>false</em> skips children.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@test</td><td>1..1</td><td>XPath expression to be evaluated. The result is interpreted as a Boolean.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr></tbody></table><h3 id="if-source" tabindex="-1">if-source <a class="header-anchor" href="#if-source" aria-label="Permalink to &quot;if-source&quot;">​</a></h3><pre><code>&lt;if-source
    optional=&quot;Boolean value&quot;
    trace=&quot;String value&quot;
    xpath=&quot;XPath node expression&quot;
/&gt;
</code></pre><p>If the <code>@xpath</code> exists, temporarily change the script&#39;s current source to that node and execute any child operations. Relative paths in child operations are relative to the indicated node. The effective source resets to its previous value upon completion of child processing.</p><p>This is a shortcut to using <code>&lt;source xpath=&quot;...&quot; required=&quot;false&quot;/&gt;</code></p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@xpath</td><td>1..1</td><td>XPath expression evaluating to an existing input document node.</td></tr></tbody></table><p>See also <a href="#source">source</a>.</p><h3 id="if-target" tabindex="-1">if-target <a class="header-anchor" href="#if-target" aria-label="Permalink to &quot;if-target&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">if-target</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        xpath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>If the <code>@xpath</code> exists, temporarily change the script&#39;s current target to that node and execute any child operations. Relative paths in child operations are relative to the indicated node. The effective target resets to its previous value upon completion of child processing.</p><p>This is a shortcut to using <code>&lt;target xpath=&quot;...&quot; required=&quot;false&quot;/&gt;</code>.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@xpath</td><td>1..1</td><td>XPath expression evaluating to an existing output document node.</td></tr></tbody></table><p>See also <a href="#ensure-target">ensure-target</a> and <a href="#target">target</a>.</p><h3 id="mysql" tabindex="-1">mysql <a class="header-anchor" href="#mysql" aria-label="Permalink to &quot;mysql&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        database</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        MYSQL_...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        password</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        resultset-tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath string expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        secret</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        section</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        vault</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">bind</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">              value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath string expression&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;...&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@database</td><td>0..1</td><td>Name of the database to run the sql statement on. Required if not provided in a <em>vault</em> or <em>secret</em>. See the following <a href="#credentials">Credentials</a> section for further explanation.</td></tr><tr><td>@MYSQL_...</td><td>0..n</td><td>A MySQL option to set on the sql transaction. The full name of the attribute should match a MySQL option enum name e.g. <code>MYSQL_SET_CHARSET_NAME</code></td></tr><tr><td>@name</td><td>0..1</td><td>Name of the node inside <code>@section</code> where the output is placed. If it does not exist it is created.</td></tr><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@password</td><td>0..1</td><td>String of the password to login to the database server. Required if not provided in a <em>vault</em> or <em>secret</em>. See the following <a href="#credentials">Credentials</a> section for further explanation.</td></tr><tr><td>@resultset-tag</td><td>0..1</td><td>The name of the node holding the resultset generated by executing the sql statement. This node is created in the script context at the location <em><code>section</code></em><code>/</code><em><code>name</code></em><code>/</code><em><code>resultset-tag</code></em></td></tr><tr><td>@secret</td><td>0..1</td><td>String of the secret name to retrieve database login info from. The category name used is <em>esp</em>. For security, preferred usage is to include user, password, server and database together. See the following <a href="#credentials">Credentials</a> section for further explanation.</td></tr><tr><td>@section</td><td>0..1</td><td>Path to the section of script context where output is placed. If omitted defaults to <code>temporaries</code>.</td></tr><tr><td>@select</td><td>0..1</td><td>XPath node expression used as root of the source for binding sql parameters. When provided, the mysql operation will run once for each node in the expression result.</td></tr><tr><td>@server</td><td>1..1</td><td>String value of the database server in the format <em>ip:port</em> or <em>hostname:port</em>. Required if not provided in a <em>vault</em> or <em>secret</em>. See the following <a href="#credentials">Credentials</a> section for further explanation.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@user</td><td>0..1</td><td>String of the user name to login to the database server. Required if not provided in a <em>vault</em> or <em>secret</em>. See the following <a href="#credentials">Credentials</a> section for further explanation.</td></tr><tr><td>@vault</td><td>0..1</td><td>String of the vault ID to retrieve database login info from. The category name used is <em>esp</em>. For security, preferred usage is to include user, password, server and database together. See the following <a href="#credentials">Credentials</a> section for further explanation.</td></tr><tr><td>bind</td><td>0..n</td><td>Node to bind a value to a sql parameter.</td></tr><tr><td>bind/@name</td><td>1..1</td><td>String of the name of the sql parameter. Use only one instance per <code>bind</code> node.</td></tr><tr><td>bind/@value</td><td>1..1</td><td>XPath string expression of the value of the parameter. Use only one instance per <code>bind</code> node.</td></tr><tr><td>sql</td><td>1..1</td><td>Required element whose contents are an sql statement to execute.</td></tr></tbody></table><h4 id="credentials" tabindex="-1">Credentials <a class="header-anchor" href="#credentials" aria-label="Permalink to &quot;Credentials&quot;">​</a></h4><p>The required credentials are <em>server</em>, <em>user</em>, <em>password</em> and <em>database</em>. They can be supplied to this operation three ways: from a vault, from a local secret store or directly in attributes. Only <em>one</em> set of the following attributes are required to be populated in order to supply credentials:</p><table tabindex="0"><thead><tr><th>Vault</th><th>Local Secrets</th><th>Direct Attributes</th></tr></thead><tbody><tr><td><code>@vault</code></td><td><code>@secret</code></td><td><code>@server</code>, <code>@user</code>, <code>@password</code> and <code>@database</code></td></tr></tbody></table><p>The system looks for values first in the vault, then the secrets store and finally in the direct attributes. The credential lookup process is:</p><ol><li>If the vault exists use credentials from the vault. If any value is missing from the vault attempt to use the value from the direct attribute. If the attribute doesn&#39;t provide a value then an exception is thrown.</li><li>If the local secrets store exists use the credentials from the local secrets store. If any value is missing from the store attempt to use the value from the direct attribute. If the attribute doesn&#39;t provide a value then an exception is thrown.</li><li>If neither the vault nor the store exist then attempt to use all values from the direct attributes. If any attribute doesn&#39;t provide a value then an exception is thrown.</li></ol><p>A discussion of how to use a vault is beyond the scope of this document, but we&#39;ll outline how to use the local secrets store.</p><p>The local secrets store is a mount point containing <em>category</em> folders. Each <em>category</em> folder further contains <em>secret</em> folders, which contains files named for one piece of secret info. Each info file contains the secret value corresponding to the file name. In a standard HPCCSystems platform installation, the secrets mount point is <code>/opt/HPCCSystems/secrets</code>, though this is determined by the location of the running esp executable. The ESDL Script secrets use the <code>esp</code> category name, so if our secret is set to <code>@secret=&quot;FooBarDBQA&quot;</code> the files required to supply credentials for this operation are:</p><ul><li><code>/opt/HPCCSystems/secrets/esp/FooBarDBQA/server</code></li><li><code>/opt/HPCCSystems/secrets/esp/FooBarDBQA/user</code></li><li><code>/opt/HPCCSystems/secrets/esp/FooBarDBQA/password</code></li><li><code>/opt/HPCCSystems/secrets/esp/FooBarDBQA/database</code></li></ul><h4 id="examples" tabindex="-1">Examples <a class="header-anchor" href="#examples" aria-label="Permalink to &quot;Examples&quot;">​</a></h4><p>Say we have a MySQL database <code>foo</code> with table <code>bar</code> running in a QA environment on 192.168.1.1. We will connect to it with the username <em>testuser</em> and password <em>Password1</em>. It was created with this schema:</p><div class="language-SQL vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\` (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  \`unique_id\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  \`inserted_at\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> datetime</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  \`name\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  \`phone\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (unique_id, inserted_at)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>Our secrets files are setup as below:</p><table tabindex="0"><thead><tr><th>File</th><th>Contents</th></tr></thead><tbody><tr><td><code>secrets/esp/FooBarDBQA/server</code></td><td>192.168.1.1</td></tr><tr><td><code>secrets/esp/FooBarDBQA/user</code></td><td>testuser</td></tr><tr><td><code>secrets/esp/FooBarDBQA/password</code></td><td>Password1</td></tr><tr><td><code>secrets/esp/FooBarDBQA/database</code></td><td>foo</td></tr></tbody></table><p>The contents of the database are:</p><table tabindex="0"><thead><tr><th>unique_id</th><th>inserted_at</th><th>name</th><th>phone</th></tr></thead><tbody><tr><td>100</td><td>2022-01-01 02:10:03</td><td>Robin Anderson</td><td>3205551212</td></tr><tr><td>101</td><td>2022-01-01 03:13:27</td><td>Chris Bakerson</td><td>9525551212</td></tr><tr><td>102</td><td>2022-03-24 14:30:06</td><td>Mia Smith</td><td>9175551212</td></tr><tr><td>103</td><td>2022-04-16 20:43:18</td><td>Italo Calvino</td><td>2125551212</td></tr><tr><td>104</td><td>2022-05-02 07:16:57</td><td>Octavia Yamoto</td><td>3075551212</td></tr></tbody></table><p>Then we execute these <code>mysql</code> operations:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:variable</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;inputs&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tokenize(&#39;100 102 104&#39;)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:mysql</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SQL1&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            secret</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;FooBarDBQA&#39;&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            section</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;foobar&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      select count(*) as count from foo.bar where inserted_at </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&amp;gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">= &#39;2022-03-24&#39;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:mysql</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SQL2&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            secret</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;FooBarDBQA&#39;&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            section</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;foobar&#39;&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            resultset-tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;OneZeroThree&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:bind</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;unique_id&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;103&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      select * from foo.bar where unique_id = ?;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:mysql</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SQL2&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$inputs/token&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            secret</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;FooBarDBQA&#39;&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            section</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;foobar&#39;&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            resultset-tag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;EvenPhones&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:bind</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;unique_id&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      select unique_id, phone from foo.bar where unique_id = ?;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">es:mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Giving this result:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">foobar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">SQL1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;3&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">SQL1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">SQL2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">OneZeroThree</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">unique_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;103&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">unique_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">inserted_at</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;2022-04-16 20:43:18&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">inserted_at</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Italo Calvino&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">phone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;2125551212&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">phone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">OneZeroThree</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">EvenPhones</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">unique_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;100&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">unique_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">phone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;3205551212&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">phone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">unique_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;102&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">unique_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">phone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;9175551212&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">phone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">unique_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;104&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">unique_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">phone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;3075551212&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">phone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">EvenPhones</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">SQL2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">foobar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h3 id="namespace" tabindex="-1">namespace <a class="header-anchor" href="#namespace" aria-label="Permalink to &quot;namespace&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">namespace</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        current</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolen value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        prefix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        uri</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Create or use an XML namespace in the output document.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@current</td><td>0..1</td><td>Boolean flag indicating whether the identified namespace applies to the output document&#39;s current node (<em>true</em>) or does not (<em>false</em>). Defaults to <em>true</em> when <code>@uri</code> is empty and <em>false</em> otherwise.</td></tr><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@prefix</td><td>0..1</td><td>Valid XML namespace prefix string or omitted; must not be empty. Omit to define the default namespace (i.e., the namespace with no prefix). Specify an existing namespace prefix with no <code>@uri</code> to refer to the existing namespace. Specify a new prefix with an <code>@uri</code> value to define a namespace.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@uri</td><td>0..1</td><td>Namespace value to be defined. Omit to refer to an existing namespace.</td></tr></tbody></table><ul><li>While <code>@prefix</code> and <code>@uri</code> are both individually optional, at least one must be given.</li></ul><h3 id="param" tabindex="-1">param <a class="header-anchor" href="#param" aria-label="Permalink to &quot;param&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">param</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">           select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Define an immutable parameter for use by the script. It is in scope for any sibling or descendent elements.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@name</td><td>1..1</td><td>Required name of the parameter.</td></tr><tr><td>@select</td><td>0..1</td><td>Evaluation of this XPath expression gives the default value of the parameter if no value is supplied by the script engine. If omitted the default value is an empty string.</td></tr></tbody></table><h3 id="remove-node" tabindex="-1">remove-node <a class="header-anchor" href="#remove-node" aria-label="Permalink to &quot;remove-node&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">remove-node</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        all</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        xpath_target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node-set value&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Remove the indicated node or nodes from the output document. If <code>@all</code> is <em>false</em>, the request applies to one uniquely identified node and multiple matching nodes result in an <em>Ambiguous XPath</em> runtime error returned. If <code>@all</code> is <em>true</em>, the request applies to any number of identified nodes.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@all</td><td>0..1</td><td>Boolean flag indicating whether the request applies to all matching nodes (<em>true</em>) or if the request must uniquely identify a single node (<em>false</em>). Defaults to <em>false</em>.</td></tr><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@target</td><td>0..1</td><td>String referring to zero or more output document nodes.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@xpath_target</td><td>0..1</td><td>XPath identifying a possibly empty set of output document nodes.</td></tr></tbody></table><ul><li>While <code>@target</code> and <code>@xpath_target</code> are both individually optional, at least one must be given. If both are given, <code>@xpath_target</code> is used.</li></ul><h3 id="rename-node" tabindex="-1">rename-node <a class="header-anchor" href="#rename-node" aria-label="Permalink to &quot;rename-node&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">rename-node</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        all</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        new_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        xpath_new_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        xpath_target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node set value&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Rename the indicated node or nodes in the output document. If <code>@all</code> is <em>false</em>, the request applies to one uniquely identified node and multiple matching nodes result in an <em>Ambiguous XPath</em> runtime error returned. If <code>@all</code> is <em>true</em>, the request applies to any number of identified nodes.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@all</td><td>0..1</td><td>Boolean flag indicating whether the request applies to all matching nodes (<em>true</em>) or if the request must uniquely identify a single node (<em>false</em>). Defaults to <em>false</em>.</td></tr><tr><td>@new_name</td><td>0..1</td><td>String containing a valid XML node name.</td></tr><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@target</td><td>0..1</td><td>String referring to zero or more output document nodes.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@xpath_new_name</td><td>0..1</td><td>XPath evaluating to a valid XML node name.</td></tr><tr><td>@xpath_target</td><td>0..1</td><td>XPath identifying a possibly empty set of output document nodes.</td></tr></tbody></table><ul><li>While <code>@target</code> and <code>@xpath_target</code> are both individually optional, at least one must be given. If both are given, <code>@xpath_target</code> is used.</li><li>While <code>@new_name</code> and <code>@xpath_new_name</code> are both individually optional, at least one must be given. If both are given, <code>@xpath_new_name</code> is used.</li></ul><h3 id="set-log-option" tabindex="-1">set-log-option <a class="header-anchor" href="#set-log-option" aria-label="Permalink to &quot;set-log-option&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">set-log-option</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        xpath_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Add a name-value pair to the <em>logging</em> section of the script context. To avoid name collisions with <code>set-log-profile</code>, the name <code>profile</code> should be avoided. To disable a log agent, use the name <code>disable-log-type-&lt;agent type value&gt;</code>.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@name</td><td>0..1</td><td>String label identifying a value. May be a log agent variant type identifier to control enabled log agents on a per-transaction basis.</td></tr><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@select</td><td>1..1</td><td>XPath evaluating to an option value. The value should be a Boolean if the name is a log agent variant type identifier and will be used to control a log agent&#39;s state.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@xpath_name</td><td>0..1</td><td>Xpath evaluating to a value identifier. May be a log agent variant type identifier to control enabled log agents on a per-transaction basis.</td></tr></tbody></table><ul><li>While <code>@name</code> and <code>@xpath_name</code> are both individually optional, at least one must be given. If both are given, <code>@xpath_name</code> is used.</li></ul><p>This option is passed to <em>LogAgents</em> in their request:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">UpdateLogRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">logging</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> option-name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;option-value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">UpdateLogRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>and can be referenced from a loggingagent configuration with the xpath <code>logging[@</code><em><code>option-name</code></em><code>]</code></p><p>See also <a href="#set-log-profile">set-log-profile</a>, <a href="#getLogOption">getLogOption</a> and <a href="#getLogOption">logOptionExists</a>.</p><h3 id="set-log-profile" tabindex="-1">set-log-profile <a class="header-anchor" href="#set-log-profile" aria-label="Permalink to &quot;set-log-profile&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">set-log-profile</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Add or update a name-value pair in the <em>logging</em> section of the script context. The name is always <code>profile</code>. The value should match a log agent variant group identifier to enable or disble groups of related log agents.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@select</td><td>1..1</td><td>XPath evaluating to a log agent variant group identifier.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr></tbody></table><p>See also <a href="#getLogProfile">getLogProfile</a>.</p><h3 id="set-value" tabindex="-1">set-value <a class="header-anchor" href="#set-value" aria-label="Permalink to &quot;set-value&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">set-value</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath evaluated as string&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        xpath_target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath evaluated as string&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Given an output destination XPath, add a new element with the given value, if one does not already exist, or replace the existing element value. The path must uniquely identify an element to be created or updated.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@name</td><td>0..1</td><td>Alternate value for trace output when <code>@trace</code> is empty. This exists for backward compatibility.</td></tr><tr><td>@required</td><td>0..1</td><td>Boolean flag indicating whether a failure to traverse the path to the leaf yields an exception (<em>true</em>) or silent failure (<em>false</em>).</td></tr><tr><td>@select</td><td>0..1</td><td>XPath expression evaluated to produce the new value content.</td></tr><tr><td>@target</td><td>0..1</td><td>XPath for the element to be updated or created, if <code>@xpath_target</code> is omitted.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@value</td><td>0..1</td><td>The element content update, if <code>@select</code> is omitted.</td></tr><tr><td>@xpath_target</td><td>0..1</td><td>XPath expression evaluated to an XPath identifying the element to be updated or created.</td></tr></tbody></table><ul><li>While <code>target</code> and <code>xpath_target</code> are individually optional, at least one must be given. If both are given, <code>xpath_target</code> is used.</li><li>While <code>select</code> and <code>value</code> are individually optional, at least one must be given. If both are given, <code>select</code> is used.</li></ul><p><em>For backward compatibility, <code>SetValue</code> is an accepted synonym for this operation, though we discourgae its use.</em></p><h3 id="source" tabindex="-1">source <a class="header-anchor" href="#source" aria-label="Permalink to &quot;source&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">source</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        xpath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Temporarily change the script&#39;s current source node. Relative paths specified in child operations are relative to the indicated node. The effective source resets to its previous value upon completion of child processing.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@required</td><td>0..1</td><td>Boolean flag indicating whether a failure to uniquely identify an existing input node terminates processing (<em>true</em>) or skips processing child operations (<em>false</em>).</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@xpath</td><td>1..1</td><td>XPath expression evaluating to an existing input document node.</td></tr></tbody></table><p>See also <a href="#if-source">if-source</a>.</p><h3 id="store-value" tabindex="-1">store-value <a class="header-anchor" href="#store-value" aria-label="Permalink to &quot;store-value&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">store-value</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        xpath_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Add a name-value pair to the <em>store</em> section of the script context. The name must be valid as an XML attribute. The value must be encoded for storage as an attribute value.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@name</td><td>0..1</td><td>String label identifying a value.</td></tr><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@select</td><td>1..1</td><td>XPath evaluating to an option value.</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@xpath_name</td><td>0..1</td><td>Xpath evaluating to a value identifier.</td></tr></tbody></table><ul><li>While <code>@name</code> and <code>@xpath_name</code> are both individually optional, at least one must be given. If both are given, <code>@xpath_name</code> is used.</li></ul><h3 id="target" tabindex="-1">target <a class="header-anchor" href="#target" aria-label="Permalink to &quot;target&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">target</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        required</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Boolean value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        xpath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath node expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Temporarily change the script&#39;s target node to an existing output document node. Relative paths specified in child operations are relative to the indicated node. The effective target resets to its previous value upon completion of child processing.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@optional</td><td>0..1</td><td>Boolean flag indicating whether script syntax errors are fatal (<em>false</em>) or merely generate warnings (<em>true</em>). Defaults to <em>false</em>.</td></tr><tr><td>@required</td><td>0..1</td><td>Boolean flag indicating whether a failure to uniquely identify an existing output node terminates processing (<em>true</em>) or skips processing child operations (<em>false</em>).</td></tr><tr><td>@trace</td><td>0..1</td><td>Label used in trace log output messages. If omitted or empty, the element name is used.</td></tr><tr><td>@xpath</td><td>1..1</td><td>XPath expression evaluating to an existing output document node.</td></tr></tbody></table><p>See also <a href="#ensure-target">ensure-target</a> and <a href="#if-target">if-target</a>.</p><h3 id="variable" tabindex="-1">variable <a class="header-anchor" href="#variable" aria-label="Permalink to &quot;variable&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">variable</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;String value&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">              select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XPath expression&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span></code></pre></div><p>Define an immutable variable for use by the script. It is in scope for any sibling or descendent elements.</p><table tabindex="0"><thead><tr><th>Property</th><th>Count</th><th>Description</th></tr></thead><tbody><tr><td>@name</td><td>1..1</td><td>Required name of the variable.</td></tr><tr><td>@select</td><td>0..1</td><td>Evaluation of this XPath expression gives the default value of the variable.</td></tr></tbody></table>`,467)]))}const g=i(n,[["render",l]]);export{E as __pageData,g as default};
